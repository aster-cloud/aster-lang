This module is test.eligibility.struct.

Define Patient with patientId: Text, age: Int, hasInsurance: Bool, insuranceType: Text, chronicConditions: Int.

Define Service with serviceCode: Text, serviceName: Text, basePrice: Int, requiresPreAuth: Bool.

Define EligibilityCheck with eligible: Bool, reason: Text, coveragePercent: Int, estimatedCost: Int, requiresPreAuth: Bool.

To calculatePatientCost with basePrice: Int, coveragePercent: Int, produce Int:
  Let coverageAmount be *(basePrice, coveragePercent).
  Let patientPercent be -(100, coveragePercent).
  Let patientCost be *(basePrice, patientPercent).
  Return patientCost.

To checkServiceEligibility with patient: Patient, service: Service, produce EligibilityCheck:
  If not(patient.hasInsurance),:
    Return EligibilityCheck with eligible = false, reason = "No insurance coverage", coveragePercent = 0, estimatedCost = service.basePrice, requiresPreAuth = false.

  Return EligibilityCheck with eligible = true, reason = "Has insurance", coveragePercent = 80, estimatedCost = calculatePatientCost(service.basePrice, 80), requiresPreAuth = service.requiresPreAuth.
