<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PII 污点分析算法设计 | Aster Language</title>
    <meta name="description" content="A pragmatic, safe, fast language with a human CNL surface">
    <meta name="generator" content="VitePress v2.0.0-alpha.15">
    <link rel="preload stylesheet" href="/assets/style.G5Z68FhG.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.BexVkAOt.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.D0q-ibex.js">
    <link rel="modulepreload" href="/assets/chunks/framework.Bz2R-749.js">
    <link rel="modulepreload" href="/assets/reference_pii-taint-analysis.md.B7chE1N_.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-1df9f90f><!--[--><!--]--><!--[--><span tabindex="-1" data-v-331ec75c></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-331ec75c>Skip to content</a><!--]--><!----><header class="VPNav" data-v-1df9f90f data-v-da52a441><div class="VPNavBar" data-v-da52a441 data-v-70946a35><div class="wrapper" data-v-70946a35><div class="container" data-v-70946a35><div class="title" data-v-70946a35><div class="VPNavBarTitle has-sidebar" data-v-70946a35 data-v-1e38c6bc><a class="title" href="/" data-v-1e38c6bc><!--[--><!--]--><!--[--><img class="VPImage logo" src="/logo.svg" alt data-v-8426fc1a><!--]--><span data-v-1e38c6bc>Aster Language</span><!--[--><!--]--></a></div></div><div class="content" data-v-70946a35><div class="content-body" data-v-70946a35><!--[--><!--]--><div class="VPNavBarSearch search" data-v-70946a35><!--[--><!----><div id="local-search"><button type="button" aria-label="Search" aria-keyshortcuts="/ control+k meta+k" class="DocSearch DocSearch-Button"><span class="DocSearch-Button-Container"><span class="vpi-search DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key"></kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-70946a35 data-v-39714824><span id="main-nav-aria-label" class="visually-hidden" data-v-39714824> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/guide/getting-started.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>Guide</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/guide/formatting.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>Formatting</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/reference/syntax.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>Reference</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/api/overview.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>API</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://github.com/wontlost-ltd/aster-lang" target="_blank" rel="noreferrer" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>GitHub</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-70946a35 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-70946a35 data-v-0394ad82 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/wontlost-ltd/aster-lang" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-70946a35 data-v-bf2fac68 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-42cb505d><span class="vpi-more-horizontal icon" data-v-42cb505d></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><!----><!--[--><!--[--><!----><div class="group" data-v-bf2fac68><div class="item appearance" data-v-bf2fac68><p class="label" data-v-bf2fac68>Appearance</p><div class="appearance-action" data-v-bf2fac68><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bf2fac68 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bf2fac68><div class="item social-links" data-v-bf2fac68><div class="VPSocialLinks social-links-list" data-v-bf2fac68 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/wontlost-ltd/aster-lang" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-70946a35 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-70946a35><div class="divider-line" data-v-70946a35></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-1df9f90f data-v-db738f89><div class="container" data-v-db738f89><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-db738f89><span class="vpi-align-left menu-icon" data-v-db738f89></span><span class="menu-text" data-v-db738f89>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-db738f89 data-v-0bf0e06f><button data-v-0bf0e06f>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-1df9f90f data-v-af661f50><div class="curtain" data-v-af661f50></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-af661f50><span class="visually-hidden" id="sidebar-aria-label" data-v-af661f50> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-8d50c081><section class="VPSidebarItem level-0" data-v-8d50c081 data-v-d81de50c><div class="item" role="button" tabindex="0" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><h2 class="text" data-v-d81de50c>Reference</h2><!----></div><div class="items" data-v-d81de50c><!--[--><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/reference/syntax.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Syntax</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/reference/types.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Types</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/reference/effects.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Effects</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-1df9f90f data-v-c87f25bf><div class="VPDoc has-sidebar has-aside" data-v-c87f25bf data-v-7011f0d8><!--[--><!--]--><div class="container" data-v-7011f0d8><div class="aside" data-v-7011f0d8><div class="aside-curtain" data-v-7011f0d8></div><div class="aside-container" data-v-7011f0d8><div class="aside-content" data-v-7011f0d8><div class="VPDocAside" data-v-7011f0d8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-60d5052e><div class="content" data-v-60d5052e><div class="outline-marker" data-v-60d5052e></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-60d5052e>On this page</div><ul class="VPDocOutlineItem root" data-v-60d5052e data-v-1ce71065><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-7011f0d8><div class="content-container" data-v-7011f0d8><!--[--><!--]--><main class="main" data-v-7011f0d8><div style="position:relative;" class="vp-doc _reference_pii-taint-analysis" data-v-7011f0d8><div><h1 id="pii-污点分析算法设计" tabindex="-1">PII 污点分析算法设计 <a class="header-anchor" href="#pii-污点分析算法设计" aria-label="Permalink to “PII 污点分析算法设计”">​</a></h1><blockquote><p><strong>状态</strong>: 设计文档 <strong>版本</strong>: 1.0 <strong>最后更新</strong>: 2025-10-06</p></blockquote><h2 id="_1-概述" tabindex="-1">1. 概述 <a class="header-anchor" href="#_1-概述" aria-label="Permalink to “1. 概述”">​</a></h2><h3 id="_1-1-动机" tabindex="-1">1.1 动机 <a class="header-anchor" href="#_1-1-动机" aria-label="Permalink to “1.1 动机”">​</a></h3><p>在现代应用中，个人身份信息（PII，Personally Identifiable Information）的安全处理至关重要。GDPR、CCPA 等隐私法规要求开发者：</p><ol><li><strong>最小化收集</strong>：仅收集必要的 PII</li><li><strong>安全传输</strong>：加密传输敏感数据</li><li><strong>访问控制</strong>：限制对 PII 的访问</li><li><strong>数据脱敏</strong>：日志和分析中移除 PII</li><li><strong>泄露通知</strong>：检测并报告 PII 泄露</li></ol><p>手动审计代码以确保 PII 安全非常困难且易错。污点分析（Taint Analysis）通过自动跟踪 PII 数据流，检测潜在的安全风险。</p><h3 id="_1-2-目标" tabindex="-1">1.2 目标 <a class="header-anchor" href="#_1-2-目标" aria-label="Permalink to “1.2 目标”">​</a></h3><p>设计一个 PII 污点分析算法，满足以下需求：</p><ul><li><strong>自动化</strong>：自动识别 PII 数据源和不安全使用</li><li><strong>保守性</strong>：避免漏报（false negatives），宁可误报（false positives）</li><li><strong>细粒度</strong>：区分不同敏感级别（L1/L2/L3）和数据类别</li><li><strong>可操作</strong>：提供清晰的修复建议</li><li><strong>增量性</strong>：支持 LSP 实时分析</li></ul><h3 id="_1-3-威胁模型" tabindex="-1">1.3 威胁模型 <a class="header-anchor" href="#_1-3-威胁模型" aria-label="Permalink to “1.3 威胁模型”">​</a></h3><p>检测以下 PII 安全风险：</p><table tabindex="0"><thead><tr><th>威胁类型</th><th>描述</th><th>示例</th></tr></thead><tbody><tr><td><strong>未加密传输</strong></td><td>PII 通过明文 HTTP 传输</td><td><code>Http.post(&quot;/api&quot;, email)</code></td></tr><tr><td><strong>日志泄露</strong></td><td>PII 写入日志文件</td><td><code>Log.info(&quot;User: &quot; + ssn)</code></td></tr><tr><td><strong>未授权访问</strong></td><td>PII 未经认证即可访问</td><td>缺少 <code>@auth</code> 标注的 API</td></tr><tr><td><strong>未脱敏存储</strong></td><td>高敏感 PII 直接存储</td><td><code>Db.insert(&quot;users&quot;, { ssn })</code></td></tr><tr><td><strong>跨境传输</strong></td><td>PII 发送到未批准的地区</td><td><code>Http.post(&quot;https://foreign.api&quot;, data)</code></td></tr></tbody></table><p>本文档重点关注<strong>未加密传输</strong>和<strong>日志泄露</strong>的检测，其他威胁可在后续扩展。</p><h2 id="_2-pii-类型系统回顾" tabindex="-1">2. PII 类型系统回顾 <a class="header-anchor" href="#_2-pii-类型系统回顾" aria-label="Permalink to “2. PII 类型系统回顾”">​</a></h2><p>Aster 的 PII 类型系统（见 Task 5 实现）提供了静态标注：</p><h3 id="_2-1-类型标注语法" tabindex="-1">2.1 类型标注语法 <a class="header-anchor" href="#_2-1-类型标注语法" aria-label="Permalink to “2.1 类型标注语法”">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>@pii(sensitivity, category) BaseType</span></span></code></pre></div><p><strong>敏感级别</strong>：</p><ul><li><code>L1</code>：低敏感（如姓名、用户名）</li><li><code>L2</code>：中敏感（如邮箱、电话）</li><li><code>L3</code>：高敏感（如 SSN、信用卡号、健康记录）</li></ul><p><strong>数据类别</strong>：</p><ul><li><code>email</code>：电子邮件地址</li><li><code>phone</code>：电话号码</li><li><code>ssn</code>：社会保障号</li><li><code>address</code>：物理地址</li><li><code>financial</code>：金融信息</li><li><code>health</code>：健康记录</li><li><code>name</code>：姓名</li><li><code>biometric</code>：生物特征</li></ul><h3 id="_2-2-类型标注示例" tabindex="-1">2.2 类型标注示例 <a class="header-anchor" href="#_2-2-类型标注示例" aria-label="Permalink to “2.2 类型标注示例”">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Define User with</span></span>
<span class="line"><span>  email: @pii(L2, email) Text,</span></span>
<span class="line"><span>  ssn: @pii(L3, ssn) Text,</span></span>
<span class="line"><span>  name: @pii(L1, name) Text.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>To get_user with id: Text, produce User. It performs io with Sql:</span></span>
<span class="line"><span>  Return Db.query(&quot;SELECT * FROM users WHERE id = ?&quot;, [id]).</span></span></code></pre></div><h3 id="_2-3-类型系统的局限" tabindex="-1">2.3 类型系统的局限 <a class="header-anchor" href="#_2-3-类型系统的局限" aria-label="Permalink to “2.3 类型系统的局限”">​</a></h3><p>静态类型标注只能识别<strong>显式声明</strong>的 PII，无法处理：</p><ol><li><strong>动态污点</strong>：从 IO 输入读取的未标注数据</li><li><strong>间接污点</strong>：通过计算派生的 PII（如用户 ID → 邮箱）</li><li><strong>容器污点</strong>：包含 PII 的集合类型</li></ol><p>污点分析通过数据流追踪弥补这些局限。</p><h2 id="_3-污点分析基础" tabindex="-1">3. 污点分析基础 <a class="header-anchor" href="#_3-污点分析基础" aria-label="Permalink to “3. 污点分析基础”">​</a></h2><h3 id="_3-1-核心概念" tabindex="-1">3.1 核心概念 <a class="header-anchor" href="#_3-1-核心概念" aria-label="Permalink to “3.1 核心概念”">​</a></h3><p><strong>污点（Taint）</strong>：标记数据是否包含 PII 及其属性（敏感级别、类别）。</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Taint</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  |</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">kind</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Clean&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 无 PII</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  |</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">kind</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Tainted&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">sensitivity</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;L1&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;L2&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;L3&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">category</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PiiCategory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span></code></pre></div><p><strong>污点源（Source）</strong>：PII 数据的来源</p><ul><li>类型标注为 <code>@pii</code> 的变量</li><li>IO 输入（<code>Http.request.body</code>, <code>Sql.query</code> 结果）</li></ul><p><strong>污点传播（Propagation）</strong>：污点如何在数据流中传递</p><ul><li>赋值、函数调用、容器操作、字符串拼接</li></ul><p><strong>敏感操作（Sink）</strong>：可能导致 PII 泄露的操作</p><ul><li><code>Http.post</code>, <code>Http.get</code>（未加密）</li><li><code>Log.info</code>, <code>Log.debug</code>（日志记录）</li><li><code>Db.insert</code>, <code>Db.update</code>（未脱敏存储）</li></ul><h3 id="_3-2-分析流程" tabindex="-1">3.2 分析流程 <a class="header-anchor" href="#_3-2-分析流程" aria-label="Permalink to “3.2 分析流程”">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>┌──────────────┐</span></span>
<span class="line"><span>│ 1. 污点源识别 │  标记所有 PII 数据</span></span>
<span class="line"><span>└──────┬───────┘</span></span>
<span class="line"><span>       │</span></span>
<span class="line"><span>       v</span></span>
<span class="line"><span>┌──────────────┐</span></span>
<span class="line"><span>│ 2. 污点传播   │  跟踪数据流图</span></span>
<span class="line"><span>└──────┬───────┘</span></span>
<span class="line"><span>       │</span></span>
<span class="line"><span>       v</span></span>
<span class="line"><span>┌──────────────┐</span></span>
<span class="line"><span>│ 3. Sink 检测  │  识别敏感操作</span></span>
<span class="line"><span>└──────┬───────┘</span></span>
<span class="line"><span>       │</span></span>
<span class="line"><span>       v</span></span>
<span class="line"><span>┌──────────────┐</span></span>
<span class="line"><span>│ 4. 诊断生成   │  报告安全风险</span></span>
<span class="line"><span>└──────────────┘</span></span></code></pre></div><h2 id="_4-污点标记与追踪" tabindex="-1">4. 污点标记与追踪 <a class="header-anchor" href="#_4-污点标记与追踪" aria-label="Permalink to “4. 污点标记与追踪”">​</a></h2><h3 id="_4-1-污点环境" tabindex="-1">4.1 污点环境 <a class="header-anchor" href="#_4-1-污点环境" aria-label="Permalink to “4.1 污点环境”">​</a></h3><p>污点环境记录每个变量的污点状态：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> TaintEnv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">VariableName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TaintSet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> TaintSet</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  taints</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Taint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 可能包含多个 PII 类别</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> mergeTaints</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> TaintSet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">b</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> TaintSet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> TaintSet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { taints: [</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">a.taints, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">b.taints] }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="_4-2-污点源识别算法" tabindex="-1">4.2 污点源识别算法 <a class="header-anchor" href="#_4-2-污点源识别算法" aria-label="Permalink to “4.2 污点源识别算法”">​</a></h3><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>function identifySources(module: Core.Module): TaintEnv {</span></span>
<span class="line"><span>  let env: TaintEnv = {}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  for each function f in module.decls {</span></span>
<span class="line"><span>    // 1. 识别参数中的 PII 类型标注</span></span>
<span class="line"><span>    for each param in f.params {</span></span>
<span class="line"><span>      if param.type is @pii(sensitivity, category) {</span></span>
<span class="line"><span>        env[param.name] = { taints: [{ kind: &#39;Tainted&#39;, sensitivity, category }] }</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    // 2. 识别 Data 字段中的 PII</span></span>
<span class="line"><span>    for each field in f.body.bindings {</span></span>
<span class="line"><span>      if field.type is @pii(sensitivity, category) {</span></span>
<span class="line"><span>        env[field.name] = { taints: [{ kind: &#39;Tainted&#39;, sensitivity, category }] }</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    // 3. 识别 IO 输入（保守假设）</span></span>
<span class="line"><span>    for each call in findCalls(f.body) {</span></span>
<span class="line"><span>      if call.target matches IO_INPUT_PATTERNS {</span></span>
<span class="line"><span>        // Http.request.body, Sql.query 等返回值假设为污点</span></span>
<span class="line"><span>        env[call.resultVar] = { taints: [{ kind: &#39;Tainted&#39;, sensitivity: &#39;L2&#39;, category: &#39;unknown&#39; }] }</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  return env</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const IO_INPUT_PATTERNS = [</span></span>
<span class="line"><span>  &#39;Http.request.body&#39;,</span></span>
<span class="line"><span>  &#39;Http.request.query&#39;,</span></span>
<span class="line"><span>  &#39;Sql.query&#39;,</span></span>
<span class="line"><span>  &#39;Db.find&#39;,</span></span>
<span class="line"><span>  &#39;Files.read&#39;</span></span>
<span class="line"><span>]</span></span></code></pre></div><h3 id="_4-3-示例-污点源识别" tabindex="-1">4.3 示例：污点源识别 <a class="header-anchor" href="#_4-3-示例-污点源识别" aria-label="Permalink to “4.3 示例：污点源识别”">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Define User with</span></span>
<span class="line"><span>  email: @pii(L2, email) Text,</span></span>
<span class="line"><span>  ssn: @pii(L3, ssn) Text.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>To get_user with id: Text, produce User. It performs io with Sql:</span></span>
<span class="line"><span>  Let user = Db.query(&quot;SELECT * FROM users WHERE id = ?&quot;, [id]).</span></span>
<span class="line"><span>  Return user.</span></span></code></pre></div><p>污点环境：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>env = {</span></span>
<span class="line"><span>  &#39;user&#39;: { taints: [{ kind: &#39;Tainted&#39;, sensitivity: &#39;L2&#39;, category: &#39;unknown&#39; }] }</span></span>
<span class="line"><span>  // Db.query 返回值保守标记为污点</span></span>
<span class="line"><span>}</span></span></code></pre></div><h2 id="_5-污点传播规则" tabindex="-1">5. 污点传播规则 <a class="header-anchor" href="#_5-污点传播规则" aria-label="Permalink to “5. 污点传播规则”">​</a></h2><h3 id="_5-1-基本传播规则" tabindex="-1">5.1 基本传播规则 <a class="header-anchor" href="#_5-1-基本传播规则" aria-label="Permalink to “5.1 基本传播规则”">​</a></h3><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>function propagateTaint(expr: Core.Expr, env: TaintEnv): TaintSet {</span></span>
<span class="line"><span>  switch expr.kind {</span></span>
<span class="line"><span>    case &#39;Name&#39;:</span></span>
<span class="line"><span>      // 变量引用：返回变量的污点</span></span>
<span class="line"><span>      return env[expr.name] || { taints: [] }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    case &#39;String&#39;, &#39;Int&#39;, &#39;Double&#39;, &#39;Bool&#39;:</span></span>
<span class="line"><span>      // 字面量：无污点</span></span>
<span class="line"><span>      return { taints: [] }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    case &#39;Call&#39;:</span></span>
<span class="line"><span>      // 函数调用：保守假设返回值继承所有参数的污点</span></span>
<span class="line"><span>      let argTaints = expr.args.map(arg =&gt; propagateTaint(arg, env))</span></span>
<span class="line"><span>      return unionAll(argTaints)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    case &#39;Construct&#39;:</span></span>
<span class="line"><span>      // 构造数据类型：继承字段污点</span></span>
<span class="line"><span>      let fieldTaints = expr.fields.map(field =&gt; propagateTaint(field.expr, env))</span></span>
<span class="line"><span>      return unionAll(fieldTaints)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    case &#39;Field&#39;:</span></span>
<span class="line"><span>      // 字段访问：obj.field 继承 obj 的污点</span></span>
<span class="line"><span>      let objTaint = propagateTaint(expr.obj, env)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>      // 如果字段本身有 @pii 标注，合并两者</span></span>
<span class="line"><span>      let fieldType = lookupFieldType(expr.obj, expr.name)</span></span>
<span class="line"><span>      if fieldType is @pii(sensitivity, category) {</span></span>
<span class="line"><span>        return merge(objTaint, { taints: [{ kind: &#39;Tainted&#39;, sensitivity, category }] })</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>      return objTaint</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    case &#39;BinOp&#39;:</span></span>
<span class="line"><span>      // 二元操作（+, -, *, /, ==, etc.）</span></span>
<span class="line"><span>      if expr.op == &#39;+&#39; and (isString(expr.left) or isString(expr.right)) {</span></span>
<span class="line"><span>        // 字符串拼接：继承两边污点</span></span>
<span class="line"><span>        return union(propagateTaint(expr.left, env), propagateTaint(expr.right, env))</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>      else {</span></span>
<span class="line"><span>        // 数值/布尔运算：保守假设继承污点</span></span>
<span class="line"><span>        return union(propagateTaint(expr.left, env), propagateTaint(expr.right, env))</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    case &#39;If&#39;:</span></span>
<span class="line"><span>      // if 表达式：返回两个分支污点的并集</span></span>
<span class="line"><span>      let thenTaint = propagateTaint(expr.then, env)</span></span>
<span class="line"><span>      let elseTaint = propagateTaint(expr.else, env)</span></span>
<span class="line"><span>      return union(thenTaint, elseTaint)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    case &#39;Match&#39;:</span></span>
<span class="line"><span>      // match 表达式：返回所有分支污点的并集</span></span>
<span class="line"><span>      let caseTaints = expr.cases.map(c =&gt; propagateTaint(c.body, env))</span></span>
<span class="line"><span>      return unionAll(caseTaints)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    case &#39;List&#39;:</span></span>
<span class="line"><span>      // List 构造：继承所有元素污点</span></span>
<span class="line"><span>      let elemTaints = expr.elems.map(e =&gt; propagateTaint(e, env))</span></span>
<span class="line"><span>      return unionAll(elemTaints)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    case &#39;Map&#39;:</span></span>
<span class="line"><span>      // Map 构造：继承所有 key 和 value 的污点</span></span>
<span class="line"><span>      let kvTaints = expr.entries.flatMap(e =&gt; [</span></span>
<span class="line"><span>        propagateTaint(e.key, env),</span></span>
<span class="line"><span>        propagateTaint(e.value, env)</span></span>
<span class="line"><span>      ])</span></span>
<span class="line"><span>      return unionAll(kvTaints)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    default:</span></span>
<span class="line"><span>      // 未知表达式：保守假设为污点（误报优于漏报）</span></span>
<span class="line"><span>      return { taints: [{ kind: &#39;Tainted&#39;, sensitivity: &#39;L3&#39;, category: &#39;unknown&#39; }] }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function unionAll(taintSets: TaintSet[]): TaintSet {</span></span>
<span class="line"><span>  let allTaints = taintSets.flatMap(ts =&gt; ts.taints)</span></span>
<span class="line"><span>  return { taints: allTaints }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function union(a: TaintSet, b: TaintSet): TaintSet {</span></span>
<span class="line"><span>  return { taints: [...a.taints, ...b.taints] }</span></span>
<span class="line"><span>}</span></span></code></pre></div><h3 id="_5-2-语句级污点传播" tabindex="-1">5.2 语句级污点传播 <a class="header-anchor" href="#_5-2-语句级污点传播" aria-label="Permalink to “5.2 语句级污点传播”">​</a></h3><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>function propagateStmt(stmt: Core.Statement, env: TaintEnv): TaintEnv {</span></span>
<span class="line"><span>  switch stmt.kind {</span></span>
<span class="line"><span>    case &#39;Let&#39;:</span></span>
<span class="line"><span>      // Let x = expr: 更新 env[x] 为 expr 的污点</span></span>
<span class="line"><span>      let exprTaint = propagateTaint(stmt.expr, env)</span></span>
<span class="line"><span>      env[stmt.name] = exprTaint</span></span>
<span class="line"><span>      return env</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    case &#39;Return&#39;:</span></span>
<span class="line"><span>      // Return 不更新环境</span></span>
<span class="line"><span>      return env</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    default:</span></span>
<span class="line"><span>      return env</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function propagateFunc(f: Core.Func): TaintEnv {</span></span>
<span class="line"><span>  let env = identifySourcesInFunc(f)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  for each stmt in f.body.statements {</span></span>
<span class="line"><span>    env = propagateStmt(stmt, env)</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  return env</span></span>
<span class="line"><span>}</span></span></code></pre></div><h3 id="_5-3-示例-污点传播" tabindex="-1">5.3 示例：污点传播 <a class="header-anchor" href="#_5-3-示例-污点传播" aria-label="Permalink to “5.3 示例：污点传播”">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Define User with</span></span>
<span class="line"><span>  email: @pii(L2, email) Text,</span></span>
<span class="line"><span>  name: @pii(L1, name) Text.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>To format_user with user: User, produce Text:</span></span>
<span class="line"><span>  Let greeting = &quot;Hello, &quot; + user.name.</span></span>
<span class="line"><span>  Let contact = &quot;Email: &quot; + user.email.</span></span>
<span class="line"><span>  Return greeting + &quot;\n&quot; + contact.</span></span></code></pre></div><p>污点传播：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>初始环境：</span></span>
<span class="line"><span>env = { &#39;user&#39;: { taints: [] } }  // 参数 user 本身未污染</span></span>
<span class="line"><span></span></span>
<span class="line"><span>user.name 访问：</span></span>
<span class="line"><span>  user.name 的类型为 @pii(L1, name) Text</span></span>
<span class="line"><span>  taint(user.name) = { taints: [{ kind: &#39;Tainted&#39;, sensitivity: &#39;L1&#39;, category: &#39;name&#39; }] }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&quot;Hello, &quot; + user.name：</span></span>
<span class="line"><span>  taint(&quot;Hello, &quot;) = { taints: [] }</span></span>
<span class="line"><span>  union(∅, L1:name) = { taints: [L1:name] }</span></span>
<span class="line"><span>  env[&#39;greeting&#39;] = { taints: [L1:name] }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>user.email 访问：</span></span>
<span class="line"><span>  taint(user.email) = { taints: [L2:email] }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&quot;Email: &quot; + user.email：</span></span>
<span class="line"><span>  env[&#39;contact&#39;] = { taints: [L2:email] }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>greeting + &quot;\n&quot; + contact：</span></span>
<span class="line"><span>  taint(result) = union(L1:name, L2:email) = { taints: [L1:name, L2:email] }</span></span></code></pre></div><h2 id="_6-敏感操作检测" tabindex="-1">6. 敏感操作检测 <a class="header-anchor" href="#_6-敏感操作检测" aria-label="Permalink to “6. 敏感操作检测”">​</a></h2><h3 id="_6-1-sink-分类" tabindex="-1">6.1 Sink 分类 <a class="header-anchor" href="#_6-1-sink-分类" aria-label="Permalink to “6.1 Sink 分类”">​</a></h3><p>定义三类 Sink 及其安全要求：</p><table tabindex="0"><thead><tr><th>Sink 类型</th><th>安全要求</th><th>允许的 PII 级别</th></tr></thead><tbody><tr><td><strong>加密传输</strong></td><td>HTTPS, TLS 1.2+</td><td>L1, L2, L3</td></tr><tr><td><strong>未加密传输</strong></td><td>HTTP</td><td>禁止所有 PII</td></tr><tr><td><strong>日志记录</strong></td><td>生产环境日志</td><td>禁止 L2, L3</td></tr><tr><td><strong>本地存储</strong></td><td>文件系统</td><td>需要加密</td></tr><tr><td><strong>数据库存储</strong></td><td>SQL/NoSQL</td><td>L3 需要加密/hash</td></tr></tbody></table><h3 id="_6-2-sink-检测算法" tabindex="-1">6.2 Sink 检测算法 <a class="header-anchor" href="#_6-2-sink-检测算法" aria-label="Permalink to “6.2 Sink 检测算法”">​</a></h3><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>function detectSinks(module: Core.Module, env: TaintEnv): SinkViolation[] {</span></span>
<span class="line"><span>  let violations: SinkViolation[] = []</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  for each function f in module.decls {</span></span>
<span class="line"><span>    for each call in findCalls(f.body) {</span></span>
<span class="line"><span>      let callTaint = propagateTaint(call, env)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>      // 检测未加密 HTTP 传输</span></span>
<span class="line"><span>      if matchesPattern(call.target, HTTP_UNENCRYPTED_PATTERNS) {</span></span>
<span class="line"><span>        if hasTaint(callTaint) {</span></span>
<span class="line"><span>          violations.add({</span></span>
<span class="line"><span>            kind: &#39;UnencryptedTransmission&#39;,</span></span>
<span class="line"><span>            location: call.span,</span></span>
<span class="line"><span>            taint: callTaint,</span></span>
<span class="line"><span>            message: generateHttpWarning(callTaint)</span></span>
<span class="line"><span>          })</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>      // 检测日志记录</span></span>
<span class="line"><span>      if matchesPattern(call.target, LOG_PATTERNS) {</span></span>
<span class="line"><span>        let highSensitivity = callTaint.taints.filter(t =&gt; t.sensitivity == &#39;L2&#39; || t.sensitivity == &#39;L3&#39;)</span></span>
<span class="line"><span>        if highSensitivity.length &gt; 0 {</span></span>
<span class="line"><span>          violations.add({</span></span>
<span class="line"><span>            kind: &#39;PiiInLogs&#39;,</span></span>
<span class="line"><span>            location: call.span,</span></span>
<span class="line"><span>            taint: { taints: highSensitivity },</span></span>
<span class="line"><span>            message: generateLogWarning(highSensitivity)</span></span>
<span class="line"><span>          })</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>      // 检测未脱敏数据库存储</span></span>
<span class="line"><span>      if matchesPattern(call.target, DB_WRITE_PATTERNS) {</span></span>
<span class="line"><span>        let l3Taints = callTaint.taints.filter(t =&gt; t.sensitivity == &#39;L3&#39;)</span></span>
<span class="line"><span>        if l3Taints.length &gt; 0 {</span></span>
<span class="line"><span>          violations.add({</span></span>
<span class="line"><span>            kind: &#39;UnsanitizedStorage&#39;,</span></span>
<span class="line"><span>            location: call.span,</span></span>
<span class="line"><span>            taint: { taints: l3Taints },</span></span>
<span class="line"><span>            message: generateDbWarning(l3Taints)</span></span>
<span class="line"><span>          })</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  return violations</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const HTTP_UNENCRYPTED_PATTERNS = [</span></span>
<span class="line"><span>  &#39;Http.post&#39;,</span></span>
<span class="line"><span>  &#39;Http.put&#39;,</span></span>
<span class="line"><span>  &#39;Http.patch&#39;,</span></span>
<span class="line"><span>  &#39;Http.get&#39;</span><span>  // 如果 URL 是 http:// 而非 https://</span></span>
<span class="line"><span>]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const LOG_PATTERNS = [</span></span>
<span class="line"><span>  &#39;Log.info&#39;,</span></span>
<span class="line"><span>  &#39;Log.debug&#39;,</span></span>
<span class="line"><span>  &#39;Log.warn&#39;,</span></span>
<span class="line"><span>  &#39;Log.error&#39;,</span></span>
<span class="line"><span>  &#39;Console.log&#39;</span></span>
<span class="line"><span>]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const DB_WRITE_PATTERNS = [</span></span>
<span class="line"><span>  &#39;Db.insert&#39;,</span></span>
<span class="line"><span>  &#39;Db.update&#39;,</span></span>
<span class="line"><span>  &#39;Sql.execute&#39;</span></span>
<span class="line"><span>]</span></span></code></pre></div><h3 id="_6-3-精细化-sink-检测" tabindex="-1">6.3 精细化 Sink 检测 <a class="header-anchor" href="#_6-3-精细化-sink-检测" aria-label="Permalink to “6.3 精细化 Sink 检测”">​</a></h3><p>对于 HTTP 调用，检查 URL 是否使用 HTTPS：</p><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>function isSecureHttp(call: Core.Call): boolean {</span></span>
<span class="line"><span>  // 检查第一个参数（URL）是否以 https:// 开头</span></span>
<span class="line"><span>  if call.args.length &gt; 0 {</span></span>
<span class="line"><span>    let urlArg = call.args[0]</span></span>
<span class="line"><span>    if urlArg.kind == &#39;String&#39; {</span></span>
<span class="line"><span>      return urlArg.value.startsWith(&#39;https://&#39;)</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // 无法静态确定：保守假设不安全</span></span>
<span class="line"><span>  return false</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function detectHttpSink(call: Core.Call, taint: TaintSet): SinkViolation? {</span></span>
<span class="line"><span>  if call.target.name == &#39;Http.post&#39; or call.target.name == &#39;Http.put&#39; {</span></span>
<span class="line"><span>    if !isSecureHttp(call) and hasTaint(taint) {</span></span>
<span class="line"><span>      return {</span></span>
<span class="line"><span>        kind: &#39;UnencryptedTransmission&#39;,</span></span>
<span class="line"><span>        location: call.span,</span></span>
<span class="line"><span>        taint: taint,</span></span>
<span class="line"><span>        message: `PII data transmitted over unencrypted HTTP. Use HTTPS instead.`</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  return null</span></span>
<span class="line"><span>}</span></span></code></pre></div><h2 id="_7-保守分析策略" tabindex="-1">7. 保守分析策略 <a class="header-anchor" href="#_7-保守分析策略" aria-label="Permalink to “7. 保守分析策略”">​</a></h2><h3 id="_7-1-精度与召回率权衡" tabindex="-1">7.1 精度与召回率权衡 <a class="header-anchor" href="#_7-1-精度与召回率权衡" aria-label="Permalink to “7.1 精度与召回率权衡”">​</a></h3><p>污点分析的两个指标：</p><ul><li><strong>精度（Precision）</strong>：报告的问题中有多少是真实问题（1 - 误报率）</li><li><strong>召回率（Recall）</strong>：真实问题中有多少被检测到（1 - 漏报率）</li></ul><p>安全分析优先召回率（避免漏报），接受一定误报：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>精度  召回率  策略</span></span>
<span class="line"><span>────────────────────</span></span>
<span class="line"><span>90%    70%   过于宽松，可能漏报高风险</span></span>
<span class="line"><span>70%    95%   理想平衡（目标）</span></span>
<span class="line"><span>50%    99%   过于保守，误报过多</span></span></code></pre></div><h3 id="_7-2-保守假设" tabindex="-1">7.2 保守假设 <a class="header-anchor" href="#_7-2-保守假设" aria-label="Permalink to “7.2 保守假设”">​</a></h3><p><strong>函数调用</strong>：</p><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>// 保守假设：返回值继承所有参数污点</span></span>
<span class="line"><span>taint(f(x, y, z)) = union(taint(x), taint(y), taint(z))</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 实际上：f 可能只使用 x，但静态分析无法确定</span></span></code></pre></div><p><strong>容器操作</strong>：</p><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>// 保守假设：整个容器被污染</span></span>
<span class="line"><span>taint([x, y, z]) = union(taint(x), taint(y), taint(z))</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 实际上：访问 list[0] 只应返回 taint(x)，但需要索引分析</span></span></code></pre></div><p><strong>控制流</strong>：</p><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>// 保守假设：所有分支的并集</span></span>
<span class="line"><span>taint(if cond then x else y) = union(taint(x), taint(y))</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 实际上：只有执行的分支会污染结果，但需要符号执行</span></span></code></pre></div><h3 id="_7-3-误报控制策略" tabindex="-1">7.3 误报控制策略 <a class="header-anchor" href="#_7-3-误报控制策略" aria-label="Permalink to “7.3 误报控制策略”">​</a></h3><p><strong>白名单（Allowlist）</strong>：</p><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>// 允许特定函数处理 PII（如加密、脱敏）</span></span>
<span class="line"><span>const SANITIZER_FUNCTIONS = [</span></span>
<span class="line"><span>  &#39;Crypto.hash&#39;,</span></span>
<span class="line"><span>  &#39;Crypto.encrypt&#39;,</span></span>
<span class="line"><span>  &#39;Pii.mask&#39;,</span></span>
<span class="line"><span>  &#39;Pii.anonymize&#39;</span></span>
<span class="line"><span>]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function propagateTaint(call: Core.Call, env: TaintEnv): TaintSet {</span></span>
<span class="line"><span>  if call.target.name in SANITIZER_FUNCTIONS {</span></span>
<span class="line"><span>    // 净化函数：移除污点</span></span>
<span class="line"><span>    return { taints: [] }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  // 正常传播</span></span>
<span class="line"><span>  return propagateCall(call, env)</span></span>
<span class="line"><span>}</span></span></code></pre></div><p><strong>敏感级别过滤</strong>：</p><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>// 只报告 L2/L3 的问题，忽略 L1</span></span>
<span class="line"><span>function shouldReport(taint: Taint): boolean {</span></span>
<span class="line"><span>  return taint.sensitivity == &#39;L2&#39; || taint.sensitivity == &#39;L3&#39;</span></span>
<span class="line"><span>}</span></span></code></pre></div><p><strong>用户标注</strong>：</p><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>// 允许开发者标注安全审计过的代码</span></span>
<span class="line"><span>// @safe-pii: 该函数已通过安全审计</span></span>
<span class="line"><span>To send_verified with data: @pii(L2, email) Text, produce Result. @safe-pii:</span></span>
<span class="line"><span>  Return Http.post(&quot;https://verified-api.com/send&quot;, data).</span></span></code></pre></div><h3 id="_7-4-误报分析示例" tabindex="-1">7.4 误报分析示例 <a class="header-anchor" href="#_7-4-误报分析示例" aria-label="Permalink to “7.4 误报分析示例”">​</a></h3><p><strong>误报场景</strong>：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>To process with user: User, produce Text:</span></span>
<span class="line"><span>  Let name_length = Text.length(user.name).  // user.name 是 @pii(L1, name)</span></span>
<span class="line"><span>  Return &quot;Name length: &quot; + name_length.</span></span></code></pre></div><p>污点分析报告：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>WARNING: PII data &#39;name&#39; (L1) used in string concatenation</span></span></code></pre></div><p><strong>实际情况</strong>： <code>name_length</code> 是一个数字，不包含 PII 信息。这是误报。</p><p><strong>改进方案</strong>： 识别&quot;脱敏函数&quot;（如 <code>Text.length</code>, <code>List.size</code>）并移除污点：</p><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>const SANITIZING_FUNCTIONS = [</span></span>
<span class="line"><span>  &#39;Text.length&#39;,</span></span>
<span class="line"><span>  &#39;List.size&#39;,</span></span>
<span class="line"><span>  &#39;Map.keys&#39;,</span><span>  // 仅返回 key，不包含 value</span></span>
<span class="line"><span>]</span></span></code></pre></div><h2 id="_8-诊断生成" tabindex="-1">8. 诊断生成 <a class="header-anchor" href="#_8-诊断生成" aria-label="Permalink to “8. 诊断生成”">​</a></h2><h3 id="_8-1-诊断级别" tabindex="-1">8.1 诊断级别 <a class="header-anchor" href="#_8-1-诊断级别" aria-label="Permalink to “8.1 诊断级别”">​</a></h3><table tabindex="0"><thead><tr><th>级别</th><th>敏感度</th><th>触发条件</th><th>示例</th></tr></thead><tbody><tr><td><strong>Error</strong></td><td>L3</td><td>高敏感 PII 未加密传输/存储</td><td>SSN 通过 HTTP 发送</td></tr><tr><td><strong>Warning</strong></td><td>L2</td><td>中敏感 PII 可能泄露</td><td>Email 写入日志</td></tr><tr><td><strong>Info</strong></td><td>L1</td><td>低敏感 PII 使用提示</td><td>Name 拼接到 URL</td></tr></tbody></table><h3 id="_8-2-诊断生成算法" tabindex="-1">8.2 诊断生成算法 <a class="header-anchor" href="#_8-2-诊断生成算法" aria-label="Permalink to “8.2 诊断生成算法”">​</a></h3><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>function generateDiagnostics(violations: SinkViolation[]): Diagnostic[] {</span></span>
<span class="line"><span>  let diagnostics: Diagnostic[] = []</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  for each violation in violations {</span></span>
<span class="line"><span>    let severity = determineSeverity(violation.taint)</span></span>
<span class="line"><span>    let message = formatMessage(violation)</span></span>
<span class="line"><span>    let suggestions = generateSuggestions(violation)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    diagnostics.add({</span></span>
<span class="line"><span>      severity: severity,</span></span>
<span class="line"><span>      message: message,</span></span>
<span class="line"><span>      location: violation.location,</span></span>
<span class="line"><span>      code: violation.kind,</span></span>
<span class="line"><span>      suggestions: suggestions,</span></span>
<span class="line"><span>      relatedInfo: traceDataFlow(violation)</span></span>
<span class="line"><span>    })</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  return diagnostics</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function determineSeverity(taint: TaintSet): &#39;error&#39; | &#39;warning&#39; | &#39;info&#39; {</span></span>
<span class="line"><span>  let maxSensitivity = max(taint.taints.map(t =&gt; t.sensitivity))</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  switch maxSensitivity {</span></span>
<span class="line"><span>    case &#39;L3&#39;: return &#39;error&#39;</span></span>
<span class="line"><span>    case &#39;L2&#39;: return &#39;warning&#39;</span></span>
<span class="line"><span>    case &#39;L1&#39;: return &#39;info&#39;</span></span>
<span class="line"><span>    default: return &#39;info&#39;</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function formatMessage(violation: SinkViolation): string {</span></span>
<span class="line"><span>  let categories = violation.taint.taints.map(t =&gt; t.category).join(&#39;, &#39;)</span></span>
<span class="line"><span>  let sensitivity = violation.taint.taints.map(t =&gt; t.sensitivity).join(&#39;, &#39;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  switch violation.kind {</span></span>
<span class="line"><span>    case &#39;UnencryptedTransmission&#39;:</span></span>
<span class="line"><span>      return `PII data (${categories}, sensitivity ${sensitivity}) transmitted over unencrypted HTTP`</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    case &#39;PiiInLogs&#39;:</span></span>
<span class="line"><span>      return `PII data (${categories}, sensitivity ${sensitivity}) written to logs`</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    case &#39;UnsanitizedStorage&#39;:</span></span>
<span class="line"><span>      return `High-sensitivity PII (${categories}) stored without encryption/hashing`</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    default:</span></span>
<span class="line"><span>      return `PII security violation: ${violation.kind}`</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function generateSuggestions(violation: SinkViolation): Suggestion[] {</span></span>
<span class="line"><span>  switch violation.kind {</span></span>
<span class="line"><span>    case &#39;UnencryptedTransmission&#39;:</span></span>
<span class="line"><span>      return [</span></span>
<span class="line"><span>        { message: &quot;Change HTTP to HTTPS in the URL&quot;, code: &quot;use-https&quot; },</span></span>
<span class="line"><span>        { message: &quot;Encrypt PII data before transmission&quot;, code: &quot;encrypt-data&quot; },</span></span>
<span class="line"><span>        { message: &quot;Remove PII from request payload&quot;, code: &quot;remove-pii&quot; }</span></span>
<span class="line"><span>      ]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    case &#39;PiiInLogs&#39;:</span></span>
<span class="line"><span>      return [</span></span>
<span class="line"><span>        { message: &quot;Use Pii.mask() to redact sensitive data&quot;, code: &quot;mask-pii&quot; },</span></span>
<span class="line"><span>        { message: &quot;Remove PII from log message&quot;, code: &quot;remove-from-log&quot; },</span></span>
<span class="line"><span>        { message: &quot;Use structured logging with PII filtering&quot;, code: &quot;structured-log&quot; }</span></span>
<span class="line"><span>      ]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    case &#39;UnsanitizedStorage&#39;:</span></span>
<span class="line"><span>      return [</span></span>
<span class="line"><span>        { message: &quot;Hash sensitive data before storage (Crypto.hash)&quot;, code: &quot;hash-data&quot; },</span></span>
<span class="line"><span>        { message: &quot;Encrypt data at rest (Crypto.encrypt)&quot;, code: &quot;encrypt-data&quot; },</span></span>
<span class="line"><span>        { message: &quot;Use tokenization for sensitive fields&quot;, code: &quot;tokenize&quot; }</span></span>
<span class="line"><span>      ]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    default:</span></span>
<span class="line"><span>      return []</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function traceDataFlow(violation: SinkViolation): RelatedInfo[] {</span></span>
<span class="line"><span>  // 追踪污点从源到 sink 的路径</span></span>
<span class="line"><span>  let path = findDataFlowPath(violation.taint)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  return path.map(node =&gt; ({</span></span>
<span class="line"><span>    message: `PII data flows through &#39;${node.expr}&#39;`,</span></span>
<span class="line"><span>    location: node.span</span></span>
<span class="line"><span>  }))</span></span>
<span class="line"><span>}</span></span></code></pre></div><h3 id="_8-3-诊断示例" tabindex="-1">8.3 诊断示例 <a class="header-anchor" href="#_8-3-诊断示例" aria-label="Permalink to “8.3 诊断示例”">​</a></h3><p><strong>示例 1：未加密 HTTP 传输</strong></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>To notify_user with email: @pii(L2, email) Text, produce Result:</span></span>
<span class="line"><span>  Return Http.post(&quot;http://api.example.com/notify&quot;, { email }).</span></span></code></pre></div><p>诊断：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>WARNING: PII data (email, sensitivity L2) transmitted over unencrypted HTTP</span></span>
<span class="line"><span>  at src/notify.aster:2:10</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Suggestions:</span></span>
<span class="line"><span>    1. Change HTTP to HTTPS in the URL</span></span>
<span class="line"><span>    2. Encrypt PII data before transmission</span></span>
<span class="line"><span>    3. Remove PII from request payload</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Data flow:</span></span>
<span class="line"><span>    - &#39;email&#39; parameter defined at line 1:18 (L2:email)</span></span>
<span class="line"><span>    - Used in Http.post call at line 2:10</span></span></code></pre></div><p><strong>示例 2：PII 日志记录</strong></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>To process_payment with ssn: @pii(L3, ssn) Text, amount: Int, produce Result:</span></span>
<span class="line"><span>  Log.info(&quot;Processing payment for SSN: &quot; + ssn + &quot;, amount: &quot; + amount).</span></span>
<span class="line"><span>  Return PaymentService.charge(ssn, amount).</span></span></code></pre></div><p>诊断：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>ERROR: PII data (ssn, sensitivity L3) written to logs</span></span>
<span class="line"><span>  at src/payment.aster:2:3</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Suggestions:</span></span>
<span class="line"><span>    1. Use Pii.mask() to redact sensitive data</span></span>
<span class="line"><span>    2. Remove PII from log message</span></span>
<span class="line"><span>    3. Use structured logging with PII filtering</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Example fix:</span></span>
<span class="line"><span>    Log.info(&quot;Processing payment for SSN: &quot; + Pii.mask(ssn) + &quot;, amount: &quot; + amount).</span></span></code></pre></div><p><strong>示例 3：跨函数传播</strong></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>To get_user_email with id: Text, produce @pii(L2, email) Text. It performs io with Sql:</span></span>
<span class="line"><span>  Let user = Db.query(&quot;SELECT email FROM users WHERE id = ?&quot;, [id]).</span></span>
<span class="line"><span>  Return user.email.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>To send_welcome with user_id: Text, produce Result:</span></span>
<span class="line"><span>  Let email = get_user_email(user_id).</span></span>
<span class="line"><span>  Return Http.post(&quot;http://welcome-service.com/send&quot;, { email }).</span></span></code></pre></div><p>诊断：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>WARNING: PII data (email, sensitivity L2) transmitted over unencrypted HTTP</span></span>
<span class="line"><span>  at src/welcome.aster:6:10</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Data flow:</span></span>
<span class="line"><span>    - &#39;email&#39; originates from get_user_email() at line 5:14 (L2:email)</span></span>
<span class="line"><span>    - Db.query returns tainted data at line 2:14</span></span>
<span class="line"><span>    - Used in Http.post call at line 6:10</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Suggestions:</span></span>
<span class="line"><span>    1. Change HTTP to HTTPS in the URL</span></span>
<span class="line"><span>    2. Encrypt PII data before transmission</span></span></code></pre></div><h2 id="_9-真实场景分析" tabindex="-1">9. 真实场景分析 <a class="header-anchor" href="#_9-真实场景分析" aria-label="Permalink to “9. 真实场景分析”">​</a></h2><h3 id="_9-1-场景-1-用户注册流程" tabindex="-1">9.1 场景 1：用户注册流程 <a class="header-anchor" href="#_9-1-场景-1-用户注册流程" aria-label="Permalink to “9.1 场景 1：用户注册流程”">​</a></h3><p><strong>代码</strong>：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Define UserInput with</span></span>
<span class="line"><span>  email: Text,</span></span>
<span class="line"><span>  password: Text,</span></span>
<span class="line"><span>  name: Text.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>To register_user with input: UserInput, produce Result. It performs io with Http and Sql:</span></span>
<span class="line"><span>  // 步骤 1：验证邮箱格式</span></span>
<span class="line"><span>  Let is_valid = Email.validate(input.email).</span></span>
<span class="line"><span>  If !is_valid:</span></span>
<span class="line"><span>    Return Err(&quot;Invalid email&quot;).</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // 步骤 2：检查邮箱是否已存在（污点源）</span></span>
<span class="line"><span>  Let existing = Db.query(&quot;SELECT * FROM users WHERE email = ?&quot;, [input.email]).</span></span>
<span class="line"><span>  If existing != null:</span></span>
<span class="line"><span>    Return Err(&quot;Email already exists&quot;).</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // 步骤 3：创建用户（污点传播）</span></span>
<span class="line"><span>  Let hashed_password = Crypto.hash(input.password).</span></span>
<span class="line"><span>  Let user = User(input.email, hashed_password, input.name).</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // 步骤 4：存储到数据库</span></span>
<span class="line"><span>  Db.insert(&quot;users&quot;, user).</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // 步骤 5：发送欢迎邮件（敏感 sink）</span></span>
<span class="line"><span>  Http.post(&quot;http://email-service.com/send&quot;, {</span></span>
<span class="line"><span>    to: user.email,</span></span>
<span class="line"><span>    subject: &quot;Welcome!&quot;,</span></span>
<span class="line"><span>    body: &quot;Hello &quot; + user.name</span></span>
<span class="line"><span>  }).</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Return Ok(&quot;User registered&quot;).</span></span></code></pre></div><p><strong>污点分析</strong>：</p><ol><li><p><strong>污点源</strong>：</p><ul><li><code>Db.query</code> 返回值 <code>existing</code> 被标记为 <code>{ taints: [L2:unknown] }</code>（保守假设）</li><li><code>input.email</code> 未标注但从外部输入，标记为 <code>{ taints: [L2:email] }</code>（启发式）</li></ul></li><li><p><strong>污点传播</strong>：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>existing (L2:unknown)</span></span>
<span class="line"><span>user.email = input.email (L2:email)</span></span>
<span class="line"><span>user.name = input.name (L1:name)</span></span></code></pre></div></li><li><p><strong>Sink 检测</strong>：</p><ul><li><code>Db.insert</code> 接收 <code>user</code>（包含 L2:email）→ <strong>通过</strong>（数据库存储允许 L2）</li><li><code>Http.post</code> 到 <code>http://</code> URL 且包含 <code>user.email</code> (L2) → <strong>警告</strong></li></ul></li><li><p><strong>诊断</strong>：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>WARNING: PII data (email, sensitivity L2) transmitted over unencrypted HTTP</span></span>
<span class="line"><span>  at register_user.aster:23:3</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Suggestions:</span></span>
<span class="line"><span>  1. Change URL to https://email-service.com/send</span></span>
<span class="line"><span>  2. Encrypt email data before transmission</span></span></code></pre></div></li></ol><p><strong>修复</strong>：</p><div class="language-diff"><button title="Copy Code" class="copy"></button><span class="lang">diff</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;">- Http.post(&quot;http://email-service.com/send&quot;, {</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">+ Http.post(&quot;https://email-service.com/send&quot;, {</span></span></code></pre></div><h3 id="_9-2-场景-2-日志调试陷阱" tabindex="-1">9.2 场景 2：日志调试陷阱 <a class="header-anchor" href="#_9-2-场景-2-日志调试陷阱" aria-label="Permalink to “9.2 场景 2：日志调试陷阱”">​</a></h3><p><strong>代码</strong>：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Define Order with</span></span>
<span class="line"><span>  id: Text,</span></span>
<span class="line"><span>  user_ssn: @pii(L3, ssn) Text,</span></span>
<span class="line"><span>  amount: Int.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>To process_order with order: Order, produce Result. It performs io with Sql:</span></span>
<span class="line"><span>  // 调试日志（不安全！）</span></span>
<span class="line"><span>  Log.debug(&quot;Processing order: &quot; + JSON.stringify(order)).</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Let result = PaymentGateway.charge(order.user_ssn, order.amount).</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Match result:</span></span>
<span class="line"><span>    Case Ok(tx_id):</span></span>
<span class="line"><span>      Log.info(&quot;Order &quot; + order.id + &quot; completed, transaction: &quot; + tx_id).</span></span>
<span class="line"><span>      Return Ok(tx_id).</span></span>
<span class="line"><span>    Case Err(msg):</span></span>
<span class="line"><span>      Log.error(&quot;Order failed: &quot; + msg + &quot;, SSN: &quot; + order.user_ssn).</span></span>
<span class="line"><span>      Return Err(msg).</span></span></code></pre></div><p><strong>污点分析</strong>：</p><ol><li><p><strong>污点源</strong>：</p><ul><li><code>order.user_ssn</code> 标注为 <code>@pii(L3, ssn)</code></li></ul></li><li><p><strong>污点传播</strong>：</p><ul><li><code>JSON.stringify(order)</code> 继承 <code>order</code> 的所有字段污点 → <code>{ taints: [L3:ssn] }</code></li><li><code>&quot;Order failed: &quot; + msg + &quot;, SSN: &quot; + order.user_ssn</code> → <code>{ taints: [L3:ssn] }</code></li></ul></li><li><p><strong>Sink 检测</strong>：</p><ul><li><code>Log.debug(...)</code> 包含 L3:ssn → <strong>错误</strong></li><li><code>Log.error(...)</code> 包含 L3:ssn → <strong>错误</strong></li></ul></li><li><p><strong>诊断</strong>：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>ERROR: PII data (ssn, sensitivity L3) written to logs</span></span>
<span class="line"><span>  at process_order.aster:8:3</span></span>
<span class="line"><span>  at process_order.aster:16:7</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Suggestions:</span></span>
<span class="line"><span>  1. Use Pii.mask() to redact SSN</span></span>
<span class="line"><span>  2. Remove SSN from log messages</span></span>
<span class="line"><span>  3. Use structured logging with field-level filtering</span></span></code></pre></div></li></ol><p><strong>修复</strong>：</p><div class="language-diff"><button title="Copy Code" class="copy"></button><span class="lang">diff</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;">- Log.debug(&quot;Processing order: &quot; + JSON.stringify(order)).</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">+ Log.debug(&quot;Processing order: &quot; + JSON.stringify({ id: order.id, amount: order.amount })).</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;">- Log.error(&quot;Order failed: &quot; + msg + &quot;, SSN: &quot; + order.user_ssn).</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">+ Log.error(&quot;Order failed: &quot; + msg + &quot;, SSN: &quot; + Pii.mask(order.user_ssn)).</span></span></code></pre></div><h3 id="_9-3-场景-3-第三方-api-集成" tabindex="-1">9.3 场景 3：第三方 API 集成 <a class="header-anchor" href="#_9-3-场景-3-第三方-api-集成" aria-label="Permalink to “9.3 场景 3：第三方 API 集成”">​</a></h3><p><strong>代码</strong>：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Define Analytics with</span></span>
<span class="line"><span>  user_id: Text,</span></span>
<span class="line"><span>  event: Text,</span></span>
<span class="line"><span>  properties: Map Text to Text.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>To track_event with user_email: @pii(L2, email) Text, event: Text, produce Result. It performs io with Http:</span></span>
<span class="line"><span>  Let analytics = Analytics(</span></span>
<span class="line"><span>    user_id: user_email,  // 使用邮箱作为 user_id（不安全！）</span></span>
<span class="line"><span>    event: event,</span></span>
<span class="line"><span>    properties: Map.empty()</span></span>
<span class="line"><span>  ).</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // 发送到第三方分析服务</span></span>
<span class="line"><span>  Return Http.post(&quot;https://analytics-vendor.com/track&quot;, analytics).</span></span></code></pre></div><p><strong>污点分析</strong>：</p><ol><li><p><strong>污点源</strong>：</p><ul><li><code>user_email</code> 参数标注为 <code>@pii(L2, email)</code></li></ul></li><li><p><strong>污点传播</strong>：</p><ul><li><code>analytics.user_id = user_email</code> → <code>analytics</code> 继承 <code>{ taints: [L2:email] }</code></li></ul></li><li><p><strong>Sink 检测</strong>：</p><ul><li><code>Http.post</code> 到 HTTPS URL → <strong>检查进一步</strong></li><li>虽然使用 HTTPS，但发送到第三方（非内部域名）→ <strong>警告</strong></li></ul></li><li><p><strong>诊断</strong>：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>WARNING: PII data (email, sensitivity L2) sent to third-party domain &#39;analytics-vendor.com&#39;</span></span>
<span class="line"><span>  at track_event.aster:11:10</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Suggestions:</span></span>
<span class="line"><span>  1. Hash or anonymize user_email before sending</span></span>
<span class="line"><span>  2. Use internal user_id instead of email</span></span>
<span class="line"><span>  3. Review data processing agreement with vendor</span></span></code></pre></div></li></ol><p><strong>修复</strong>：</p><div class="language-diff"><button title="Copy Code" class="copy"></button><span class="lang">diff</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">+ To hash_email with email: @pii(L2, email) Text, produce Text:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">+   Return Crypto.hash(email).</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">To track_event with user_email: @pii(L2, email) Text, event: Text, produce Result. It performs io with Http:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  Let analytics = Analytics(</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;">-   user_id: user_email,</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">+   user_id: hash_email(user_email),  // 使用 hash 后的标识符</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    event: event,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    properties: Map.empty()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ).</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  Return Http.post(&quot;https://analytics-vendor.com/track&quot;, analytics).</span></span></code></pre></div><h2 id="_10-实现指南" tabindex="-1">10. 实现指南 <a class="header-anchor" href="#_10-实现指南" aria-label="Permalink to “10. 实现指南”">​</a></h2><h3 id="_10-1-lsp-集成" tabindex="-1">10.1 LSP 集成 <a class="header-anchor" href="#_10-1-lsp-集成" aria-label="Permalink to “10.1 LSP 集成”">​</a></h3><p>污点分析应集成到 LSP（Language Server Protocol）以提供实时反馈：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// src/lsp/pii_diagnostics.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> analyzePii</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">document</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> TextDocument</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Diagnostic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 1. 解析文档</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> source </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getText</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ast </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> parse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">canonicalize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(source)))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> core </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> lowerModule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ast)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 2. 运行污点分析</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> taintEnv </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> identifySources</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(core)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  propagateTaints</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(core, taintEnv)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> violations </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> detectSinks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(core, taintEnv)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 3. 生成 LSP 诊断</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> violations.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> toLspDiagnostic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(v))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// src/lsp/analysis.ts (集成点)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> analyzeDocument</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">document</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> TextDocument</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Diagnostic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> diagnostics</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Diagnostic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 现有分析</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  diagnostics.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">typecheck</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(document))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  diagnostics.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lintCode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(document))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 新增：PII 污点分析</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  diagnostics.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">analyzePii</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(document))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> diagnostics</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="_10-2-配置选项" tabindex="-1">10.2 配置选项 <a class="header-anchor" href="#_10-2-配置选项" aria-label="Permalink to “10.2 配置选项”">​</a></h3><p>允许用户自定义分析行为：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// aster.config.json</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;pii&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;enabled&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;sensitivity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;minLevel&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;L2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 只报告 L2+ 的问题</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;categories&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;email&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ssn&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;financial&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 关注特定类别</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;sinks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;allowedDomains&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;internal-api.company.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 白名单域名</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;requireHttps&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      },</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;logs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;allowL1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 允许 L1 数据写入日志</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;allowL2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;allowL3&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;sanitizers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;Crypto.hash&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;Crypto.encrypt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;Pii.mask&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;Pii.anonymize&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="_10-3-测试策略" tabindex="-1">10.3 测试策略 <a class="header-anchor" href="#_10-3-测试策略" aria-label="Permalink to “10.3 测试策略”">​</a></h3><p>创建黄金测试覆盖：</p><ol><li><strong>基础污点传播</strong>：变量赋值、函数调用、字符串拼接</li><li><strong>Sink 检测</strong>：HTTP、日志、数据库</li><li><strong>跨函数传播</strong>：污点通过多个函数调用传递</li><li><strong>容器操作</strong>：List、Map 中的污点</li><li><strong>控制流</strong>：if/match 分支合并污点</li><li><strong>误报控制</strong>：净化函数、白名单域名</li><li><strong>真实场景</strong>：注册、支付、分析集成</li></ol><p>测试文件位置：<code>test/cnl/examples/pii_taint_*.aster</code></p><p>期望诊断文件：<code>test/cnl/examples/expected_pii_taint_*.diag.txt</code></p><h2 id="_11-未来扩展" tabindex="-1">11. 未来扩展 <a class="header-anchor" href="#_11-未来扩展" aria-label="Permalink to “11. 未来扩展”">​</a></h2><h3 id="_11-1-路径敏感分析" tabindex="-1">11.1 路径敏感分析 <a class="header-anchor" href="#_11-1-路径敏感分析" aria-label="Permalink to “11.1 路径敏感分析”">​</a></h3><p>当前分析是路径不敏感的（path-insensitive），即合并所有分支：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>If condition:</span></span>
<span class="line"><span>  x = pii_data.</span></span>
<span class="line"><span>Else:</span></span>
<span class="line"><span>  x = &quot;safe&quot;.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Log.info(x).  // 报告警告（误报）</span></span></code></pre></div><p>路径敏感分析可以区分不同执行路径，减少误报。</p><h3 id="_11-2-跨模块分析" tabindex="-1">11.2 跨模块分析 <a class="header-anchor" href="#_11-2-跨模块分析" aria-label="Permalink to “11.2 跨模块分析”">​</a></h3><p>当前分析限于单个模块。跨模块分析需要：</p><ol><li><strong>函数摘要（Function Summary）</strong>：记录每个函数的污点行为</li><li><strong>模块间传播</strong>：导入函数的污点传播规则</li><li><strong>增量更新</strong>：仅重新分析受影响的模块</li></ol><h3 id="_11-3-机器学习辅助" tabindex="-1">11.3 机器学习辅助 <a class="header-anchor" href="#_11-3-机器学习辅助" aria-label="Permalink to “11.3 机器学习辅助”">​</a></h3><p>使用 ML 模型改进：</p><ol><li><strong>自动识别 PII</strong>：从字段名、类型推断 PII（如 <code>email_address</code> → L2:email）</li><li><strong>减少误报</strong>：学习哪些警告被开发者忽略</li><li><strong>推荐修复</strong>：基于历史修复建议最佳实践</li></ol><h3 id="_11-4-运行时监控" tabindex="-1">11.4 运行时监控 <a class="header-anchor" href="#_11-4-运行时监控" aria-label="Permalink to “11.4 运行时监控”">​</a></h3><p>将污点分析扩展到运行时：</p><ol><li><strong>动态污点追踪</strong>：运行时标记和传播污点</li><li><strong>实时审计</strong>：记录 PII 数据流</li><li><strong>入侵检测</strong>：检测异常 PII 访问模式</li></ol><h2 id="_12-参考文献" tabindex="-1">12. 参考文献 <a class="header-anchor" href="#_12-参考文献" aria-label="Permalink to “12. 参考文献”">​</a></h2><ol><li><p><strong>Taint Analysis: A Survey</strong> Schwartz, E.J., Avgerinos, T., and Brumley, D. (2010) [Carnegie Mellon University Technical Report]</p></li><li><p><strong>Static Taint Analysis for Privacy Compliance</strong> Arzt, S., et al. (2014) FlowDroid: Precise Context, Flow, Field, Object-sensitive and Lifecycle-aware Taint Analysis for Android Apps [ACM PLDI 2014]</p></li><li><p><strong>Information Flow Control for Standard ML</strong> Zheng, L. and Myers, A.C. (2007) [ACM CSFW 2007]</p></li><li><p><strong>Practical Static Analysis of JavaScript Applications</strong> Kristensen, E.K. and Møller, A. (2014) [ACM OOPSLA 2014]</p></li><li><p><strong>GDPR Compliance by Design</strong> Bonatti, P.A., et al. (2020) <em>Data Protection in the Era of AI</em> [Springer]</p></li></ol><hr><p><strong>注</strong>：本文档描述的算法为设计阶段，实际实现时可根据性能和精度需求调整策略。优先级应放在避免漏报（高召回率），逐步改进精度（减少误报）。</p></div></div></main><footer class="VPDocFooter" data-v-7011f0d8 data-v-e257564d><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><!----></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/reference/syntax.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next page</span><span class="title" data-v-e257564d>Syntax</span><!--]--></a></div></nav></footer><!--[--><!--[--><!--[--><div class="star-callout" data-v-ae6e7d83><p data-v-ae6e7d83> Like Aster? Star us on <a href="https://github.com/wontlost-ltd/aster-lang" target="_blank" rel="noreferrer noopener" data-v-ae6e7d83>GitHub</a> to support the project. </p><p data-v-ae6e7d83><a href="https://github.com/wontlost-ltd/aster-lang" target="_blank" rel="noreferrer noopener" data-v-ae6e7d83><img alt="GitHub Stars" src="https://img.shields.io/github/stars/wontlost-ltd/aster-lang?style=social" data-v-ae6e7d83></a></p></div><!--]--><!--]--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-1df9f90f data-v-c3855bb3><div class="container" data-v-c3855bb3><p class="message" data-v-c3855bb3>Released under the MIT License.</p><p class="copyright" data-v-c3855bb3>Copyright © 2025 Aster Language Team</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"ai-generation-architecture.md\":\"Vh18j_Ok\",\"ai-generation-guide.md\":\"WZhITE4j\",\"api_canonicalizer.md\":\"DUqNQmFC\",\"api_core.md\":\"C1v-bSx3\",\"api_lexer.md\":\"6Sb7VheS\",\"api_overview.md\":\"BAFNlt86\",\"api_parser.md\":\"DB8ukesk\",\"api_typedoc_canonicalizer_functions_canonicalize.md\":\"WBPQNmQy\",\"api_typedoc_canonicalizer_readme.md\":\"DDyy-5aE\",\"api_typedoc_config_semantic_enumerations_capabilitykind.md\":\"DiMngU6F\",\"api_typedoc_config_semantic_enumerations_effect.md\":\"-Wv6MVL-\",\"api_typedoc_config_semantic_functions_getallcapabilityprefixes.md\":\"C-SGsDr5\",\"api_typedoc_config_semantic_functions_getalleffects.md\":\"ZfZkspmh\",\"api_typedoc_config_semantic_functions_infercapabilityfromname.md\":\"D3SbqIdh\",\"api_typedoc_config_semantic_functions_isbuiltinawait.md\":\"Bjk2mhHF\",\"api_typedoc_config_semantic_functions_iskeyword.md\":\"CMdz7b19\",\"api_typedoc_config_semantic_functions_isvalideffect.md\":\"BtjlRux9\",\"api_typedoc_config_semantic_functions_parseeffect.md\":\"Dxivlbar\",\"api_typedoc_config_semantic_readme.md\":\"DXzLTWAb\",\"api_typedoc_config_semantic_variables_builtin_await.md\":\"CQuSeL8o\",\"api_typedoc_config_semantic_variables_capability_prefixes.md\":\"eN_NzjtE\",\"api_typedoc_config_semantic_variables_cpu_prefixes.md\":\"DIM18Z0P\",\"api_typedoc_config_semantic_variables_io_prefixes.md\":\"rWGal5ax\",\"api_typedoc_config_semantic_variables_kw.md\":\"DzFT7LYb\",\"api_typedoc_core_ir_readme.md\":\"CzYk3jG_\",\"api_typedoc_core_ir_variables_core.md\":\"BYPCKiSN\",\"api_typedoc_error_codes_enumerations_errorcode.md\":\"DZx0lVFr\",\"api_typedoc_error_codes_functions_formaterrormessage.md\":\"CcWuzCXR\",\"api_typedoc_error_codes_functions_geterrormetadata.md\":\"CZHpQ86c\",\"api_typedoc_error_codes_interfaces_errormetadata.md\":\"B-eDU2WT\",\"api_typedoc_error_codes_readme.md\":\"A9gSR2lX\",\"api_typedoc_error_codes_type-aliases_errorcategory.md\":\"BpAN-W4i\",\"api_typedoc_error_codes_type-aliases_errorseverity.md\":\"CbW9wP3J\",\"api_typedoc_error_codes_variables_error_messages.md\":\"C1mdRvmQ\",\"api_typedoc_error_codes_variables_error_metadata.md\":\"DulV4BwE\",\"api_typedoc_index_readme.md\":\"QDJLekGi\",\"api_typedoc_index_variables_node.md\":\"DlJtLj6U\",\"api_typedoc_lexer_functions_lex.md\":\"DicCbXzf\",\"api_typedoc_lexer_readme.md\":\"DGGScc2r\",\"api_typedoc_lower_to_core_functions_lowermodule.md\":\"DVlLa1FI\",\"api_typedoc_lower_to_core_readme.md\":\"B-buQyBB\",\"api_typedoc_parser_functions_parse.md\":\"PiSfv-in\",\"api_typedoc_parser_readme.md\":\"BHmR7Q1P\",\"api_typedoc_readme.md\":\"CYskx_Mj\",\"api_typedoc_types_base_interfaces_baseawait.md\":\"BtvqNOva\",\"api_typedoc_types_base_interfaces_baseblock.md\":\"6Z6kS889\",\"api_typedoc_types_base_interfaces_basebool.md\":\"CePTDt4a\",\"api_typedoc_types_base_interfaces_basecall.md\":\"Dq9AXFca\",\"api_typedoc_types_base_interfaces_basecase.md\":\"lnb-YrQx\",\"api_typedoc_types_base_interfaces_baseconstruct.md\":\"DQWwT88l\",\"api_typedoc_types_base_interfaces_baseconstructfield.md\":\"Gc6XMagf\",\"api_typedoc_types_base_interfaces_basedata.md\":\"BRs9Bq2V\",\"api_typedoc_types_base_interfaces_basedouble.md\":\"BJqGsJ_k\",\"api_typedoc_types_base_interfaces_baseenum.md\":\"D-Je-pO0\",\"api_typedoc_types_base_interfaces_baseerr.md\":\"BuaogDmm\",\"api_typedoc_types_base_interfaces_basefield.md\":\"CDWQ3x2z\",\"api_typedoc_types_base_interfaces_basefunc.md\":\"DDrUQUG2\",\"api_typedoc_types_base_interfaces_basefunctype.md\":\"C-k8xojn\",\"api_typedoc_types_base_interfaces_baseif.md\":\"DQb_TMpD\",\"api_typedoc_types_base_interfaces_baseimport.md\":\"BXWwObGc\",\"api_typedoc_types_base_interfaces_baseint.md\":\"BS0A-qzU\",\"api_typedoc_types_base_interfaces_baselambda.md\":\"zdXq9d-P\",\"api_typedoc_types_base_interfaces_baselet.md\":\"DFVO3w7E\",\"api_typedoc_types_base_interfaces_baselist.md\":\"U8Q5Q12b\",\"api_typedoc_types_base_interfaces_baselong.md\":\"BOkmOK6-\",\"api_typedoc_types_base_interfaces_basemap.md\":\"QOV3XraL\",\"api_typedoc_types_base_interfaces_basematch.md\":\"y8sj9fE5\",\"api_typedoc_types_base_interfaces_basemaybe.md\":\"BF-ov2QO\",\"api_typedoc_types_base_interfaces_basemodule.md\":\"DHIWCHik\",\"api_typedoc_types_base_interfaces_basename.md\":\"mJqirMyR\",\"api_typedoc_types_base_interfaces_basenode.md\":\"Dmpju7mt\",\"api_typedoc_types_base_interfaces_basenone.md\":\"C2rluMyW\",\"api_typedoc_types_base_interfaces_basenull.md\":\"_RMr9EtA\",\"api_typedoc_types_base_interfaces_baseok.md\":\"BB4O3YI2\",\"api_typedoc_types_base_interfaces_baseoption.md\":\"Dir0sRHo\",\"api_typedoc_types_base_interfaces_baseparameter.md\":\"8TIciWx5\",\"api_typedoc_types_base_interfaces_basepatternctor.md\":\"yr5iOkrj\",\"api_typedoc_types_base_interfaces_basepatternint.md\":\"C6sqfWA6\",\"api_typedoc_types_base_interfaces_basepatternname.md\":\"D_LJ8S_E\",\"api_typedoc_types_base_interfaces_basepatternnull.md\":\"CmxeYogt\",\"api_typedoc_types_base_interfaces_baseresult.md\":\"D3c617pK\",\"api_typedoc_types_base_interfaces_baseretrypolicy.md\":\"BOjIZs28\",\"api_typedoc_types_base_interfaces_basereturn.md\":\"DF4gtqCH\",\"api_typedoc_types_base_interfaces_basescope.md\":\"F6jW8XV4\",\"api_typedoc_types_base_interfaces_baseset.md\":\"COXYfHII\",\"api_typedoc_types_base_interfaces_basesome.md\":\"DnfgaN7k\",\"api_typedoc_types_base_interfaces_basestart.md\":\"DJ7-g7rd\",\"api_typedoc_types_base_interfaces_basestep.md\":\"BJ9Trlu7\",\"api_typedoc_types_base_interfaces_basestring.md\":\"BpNOeyTw\",\"api_typedoc_types_base_interfaces_basetimeout.md\":\"CDWfsDmt\",\"api_typedoc_types_base_interfaces_basetypeapp.md\":\"DRrynUM5\",\"api_typedoc_types_base_interfaces_basetypename.md\":\"B2JfEqsD\",\"api_typedoc_types_base_interfaces_basetypevar.md\":\"D8PHuHoZ\",\"api_typedoc_types_base_interfaces_basewait.md\":\"8upNum21\",\"api_typedoc_types_base_interfaces_baseworkflow.md\":\"DA-czSxj\",\"api_typedoc_types_base_readme.md\":\"CE9_DSUg\",\"api_typedoc_types_base_type-aliases_hasfileprop.md\":\"ikLqWE4J\",\"api_typedoc_types_enumerations_tokenkind.md\":\"BM_yAt5G\",\"api_typedoc_types_functions_iscommenttoken.md\":\"DrEgOTzq\",\"api_typedoc_types_interfaces_annotation.md\":\"CkEPfgJk\",\"api_typedoc_types_interfaces_astmetadata.md\":\"BP44qKfb\",\"api_typedoc_types_interfaces_await.md\":\"BwctV35q\",\"api_typedoc_types_interfaces_block.md\":\"Dds4cC78\",\"api_typedoc_types_interfaces_bool.md\":\"FxplsY7_\",\"api_typedoc_types_interfaces_call.md\":\"Bn4XBA3g\",\"api_typedoc_types_interfaces_case.md\":\"D6zsiPkw\",\"api_typedoc_types_interfaces_commentvalue.md\":\"BTkSL3vk\",\"api_typedoc_types_interfaces_construct.md\":\"oIfYr1IJ\",\"api_typedoc_types_interfaces_constructfield.md\":\"Cnz0QAqG\",\"api_typedoc_types_interfaces_data.md\":\"DjJQnvW9\",\"api_typedoc_types_interfaces_double.md\":\"fKgF38FL\",\"api_typedoc_types_interfaces_effectcapable.md\":\"DWOTAter\",\"api_typedoc_types_interfaces_effectvar.md\":\"BVp5AXe0\",\"api_typedoc_types_interfaces_enum.md\":\"B00UwgiO\",\"api_typedoc_types_interfaces_err.md\":\"pB9dmUfJ\",\"api_typedoc_types_interfaces_field.md\":\"PsHn4Csn\",\"api_typedoc_types_interfaces_func.md\":\"MlaHEUYy\",\"api_typedoc_types_interfaces_functype.md\":\"6-vZuqmj\",\"api_typedoc_types_interfaces_if.md\":\"D1PKiqqA\",\"api_typedoc_types_interfaces_import.md\":\"BKI8FX07\",\"api_typedoc_types_interfaces_int.md\":\"ANec8qu3\",\"api_typedoc_types_interfaces_lambda.md\":\"7QRRiPjg\",\"api_typedoc_types_interfaces_let.md\":\"1WCoI4Gv\",\"api_typedoc_types_interfaces_list.md\":\"BvE0M76q\",\"api_typedoc_types_interfaces_long.md\":\"Df_9LjrS\",\"api_typedoc_types_interfaces_map.md\":\"bdNZ-rdw\",\"api_typedoc_types_interfaces_match.md\":\"C_zKlFpy\",\"api_typedoc_types_interfaces_maybe.md\":\"P2T9PUk1\",\"api_typedoc_types_interfaces_module.md\":\"BJHg-GmZ\",\"api_typedoc_types_interfaces_name.md\":\"CKmupHQv\",\"api_typedoc_types_interfaces_none.md\":\"DeDnQ3NO\",\"api_typedoc_types_interfaces_null.md\":\"BVY9aJD_\",\"api_typedoc_types_interfaces_ok.md\":\"BYknowER\",\"api_typedoc_types_interfaces_option.md\":\"DvADyFrb\",\"api_typedoc_types_interfaces_origin.md\":\"Bz9Krm9t\",\"api_typedoc_types_interfaces_parameter.md\":\"HbP_2nfa\",\"api_typedoc_types_interfaces_patternctor.md\":\"BsqS63fg\",\"api_typedoc_types_interfaces_patternint.md\":\"Bt9Ge8Yn\",\"api_typedoc_types_interfaces_patternname.md\":\"CLFMUkPE\",\"api_typedoc_types_interfaces_patternnull.md\":\"Beu6gSiS\",\"api_typedoc_types_interfaces_piimeta.md\":\"B-tcVLA7\",\"api_typedoc_types_interfaces_position.md\":\"D4n1y5fc\",\"api_typedoc_types_interfaces_result.md\":\"BWGZBT-p\",\"api_typedoc_types_interfaces_retrypolicy.md\":\"DceUqg9X\",\"api_typedoc_types_interfaces_return.md\":\"CoWpDCEG\",\"api_typedoc_types_interfaces_set.md\":\"BDOQgnhv\",\"api_typedoc_types_interfaces_some.md\":\"6e8EKTI8\",\"api_typedoc_types_interfaces_span.md\":\"g3cVeqBr\",\"api_typedoc_types_interfaces_start.md\":\"BB_v-dqs\",\"api_typedoc_types_interfaces_stepstmt.md\":\"WXBvOkRA\",\"api_typedoc_types_interfaces_string.md\":\"BM7MrnvB\",\"api_typedoc_types_interfaces_timeout.md\":\"CHFjIDI4\",\"api_typedoc_types_interfaces_token.md\":\"BFyuk3_o\",\"api_typedoc_types_interfaces_typeapp.md\":\"D0rs_a1h\",\"api_typedoc_types_interfaces_typecheckdiagnostic.md\":\"Dp30csBQ\",\"api_typedoc_types_interfaces_typename.md\":\"BZdV7vrD\",\"api_typedoc_types_interfaces_typepii.md\":\"DxqrM52d\",\"api_typedoc_types_interfaces_typevar.md\":\"CmYbPngw\",\"api_typedoc_types_interfaces_wait.md\":\"Ag-JlwuU\",\"api_typedoc_types_interfaces_workflowstmt.md\":\"-5sYRqPy\",\"api_typedoc_types_namespaces_core_interfaces_annotation.md\":\"DRtavQMn\",\"api_typedoc_types_namespaces_core_interfaces_await.md\":\"BsNzp_j2\",\"api_typedoc_types_namespaces_core_interfaces_block.md\":\"CJAFt7ug\",\"api_typedoc_types_namespaces_core_interfaces_bool.md\":\"DeTqk7Df\",\"api_typedoc_types_namespaces_core_interfaces_call.md\":\"BA-DbsfY\",\"api_typedoc_types_namespaces_core_interfaces_case.md\":\"DL4iKtJy\",\"api_typedoc_types_namespaces_core_interfaces_construct.md\":\"DYziutvA\",\"api_typedoc_types_namespaces_core_interfaces_constructfield.md\":\"WF-rbPOF\",\"api_typedoc_types_namespaces_core_interfaces_data.md\":\"GUbnBpqj\",\"api_typedoc_types_namespaces_core_interfaces_double.md\":\"ClolhlwM\",\"api_typedoc_types_namespaces_core_interfaces_effectvar.md\":\"CuBMTjUG\",\"api_typedoc_types_namespaces_core_interfaces_enum.md\":\"Dkp-YH79\",\"api_typedoc_types_namespaces_core_interfaces_err.md\":\"JLtHAQUP\",\"api_typedoc_types_namespaces_core_interfaces_field.md\":\"B_CBLfAx\",\"api_typedoc_types_namespaces_core_interfaces_func.md\":\"CdrM072Q\",\"api_typedoc_types_namespaces_core_interfaces_functype.md\":\"DdZESQCb\",\"api_typedoc_types_namespaces_core_interfaces_if.md\":\"BhksuViE\",\"api_typedoc_types_namespaces_core_interfaces_import.md\":\"BP_olXtF\",\"api_typedoc_types_namespaces_core_interfaces_int.md\":\"H9zaMpmg\",\"api_typedoc_types_namespaces_core_interfaces_lambda.md\":\"yb_cThu5\",\"api_typedoc_types_namespaces_core_interfaces_let.md\":\"pkDJ8C47\",\"api_typedoc_types_namespaces_core_interfaces_list.md\":\"yWhK_8n_\",\"api_typedoc_types_namespaces_core_interfaces_long.md\":\"CvfGj_ux\",\"api_typedoc_types_namespaces_core_interfaces_map.md\":\"DVMJnVh1\",\"api_typedoc_types_namespaces_core_interfaces_match.md\":\"Dl3ZI7pz\",\"api_typedoc_types_namespaces_core_interfaces_maybe.md\":\"CfX0Rknw\",\"api_typedoc_types_namespaces_core_interfaces_module.md\":\"CFgF7MlH\",\"api_typedoc_types_namespaces_core_interfaces_name.md\":\"D2bJ60Bx\",\"api_typedoc_types_namespaces_core_interfaces_none.md\":\"BL5iZ3YQ\",\"api_typedoc_types_namespaces_core_interfaces_null.md\":\"cQx17gxh\",\"api_typedoc_types_namespaces_core_interfaces_ok.md\":\"x9tFCrER\",\"api_typedoc_types_namespaces_core_interfaces_option.md\":\"DtHt_lCj\",\"api_typedoc_types_namespaces_core_interfaces_parameter.md\":\"BNvcAWfY\",\"api_typedoc_types_namespaces_core_interfaces_patctor.md\":\"Cg5TfQw1\",\"api_typedoc_types_namespaces_core_interfaces_patint.md\":\"DkAPyXXY\",\"api_typedoc_types_namespaces_core_interfaces_patname.md\":\"Cyq5lM8k\",\"api_typedoc_types_namespaces_core_interfaces_patnull.md\":\"D0N4Qk7W\",\"api_typedoc_types_namespaces_core_interfaces_piitype.md\":\"BnR_GiFH\",\"api_typedoc_types_namespaces_core_interfaces_result.md\":\"0eeB9WiX\",\"api_typedoc_types_namespaces_core_interfaces_retrypolicy.md\":\"kq2SZ92t\",\"api_typedoc_types_namespaces_core_interfaces_return.md\":\"cgSNp3sB\",\"api_typedoc_types_namespaces_core_interfaces_scope.md\":\"RIR179wD\",\"api_typedoc_types_namespaces_core_interfaces_set.md\":\"BwhbnmH-\",\"api_typedoc_types_namespaces_core_interfaces_some.md\":\"BAqnqR4h\",\"api_typedoc_types_namespaces_core_interfaces_start.md\":\"BBrpUgDx\",\"api_typedoc_types_namespaces_core_interfaces_step.md\":\"BJ8rVDln\",\"api_typedoc_types_namespaces_core_interfaces_string.md\":\"BT8hWbQO\",\"api_typedoc_types_namespaces_core_interfaces_timeout.md\":\"DCNnsi5W\",\"api_typedoc_types_namespaces_core_interfaces_typeapp.md\":\"GA-skxGA\",\"api_typedoc_types_namespaces_core_interfaces_typename.md\":\"C7ZsEecJ\",\"api_typedoc_types_namespaces_core_interfaces_typevar.md\":\"CpGnyyhq\",\"api_typedoc_types_namespaces_core_interfaces_wait.md\":\"UKxkEmXL\",\"api_typedoc_types_namespaces_core_interfaces_workflow.md\":\"DlSvRGGW\",\"api_typedoc_types_namespaces_core_readme.md\":\"NzBvLo2Y\",\"api_typedoc_types_namespaces_core_type-aliases_corenode.md\":\"CdM-pinX\",\"api_typedoc_types_namespaces_core_type-aliases_declaration.md\":\"CkdMcssh\",\"api_typedoc_types_namespaces_core_type-aliases_expression.md\":\"tbTNMueI\",\"api_typedoc_types_namespaces_core_type-aliases_pattern.md\":\"Nu3DP6qV\",\"api_typedoc_types_namespaces_core_type-aliases_statement.md\":\"BxCmeSBG\",\"api_typedoc_types_namespaces_core_type-aliases_type.md\":\"BUXcarfq\",\"api_typedoc_types_readme.md\":\"BtX9LMYn\",\"api_typedoc_types_type-aliases_astnode.md\":\"CaELsJp3\",\"api_typedoc_types_type-aliases_capabilitykind.md\":\"Ckf6mSVU\",\"api_typedoc_types_type-aliases_declaration.md\":\"BqmMJrVd\",\"api_typedoc_types_type-aliases_effectcaps.md\":\"4XK2Fsha\",\"api_typedoc_types_type-aliases_expression.md\":\"nnESKY5K\",\"api_typedoc_types_type-aliases_pattern.md\":\"C6z5WUYE\",\"api_typedoc_types_type-aliases_piidatacategory.md\":\"DMb_MLtA\",\"api_typedoc_types_type-aliases_piilevel.md\":\"CPIuBQGw\",\"api_typedoc_types_type-aliases_piisensitivitylevel.md\":\"Da_BnxF_\",\"api_typedoc_types_type-aliases_statement.md\":\"BLMrfDl1\",\"api_typedoc_types_type-aliases_type.md\":\"Bi8ZPa0d\",\"api_typedoc_types_variables_pii_levels.md\":\"D796TvSg\",\"architecture.md\":\"_DEGzzYu\",\"concurrency.md\":\"D4ZmE0BN\",\"core-ir-specification.md\":\"ZoVsz7RT\",\"cross-backend-benchmark-results.md\":\"kZqjNp3b\",\"decisions_adr-001-defer-effect-inference.md\":\"CCHSILPi\",\"dev_workflow-implementation.md\":\"Crwz1_s-\",\"error-codes.md\":\"DZiO8tN-\",\"graalvm-setup-guide.md\":\"Du9LcmOq\",\"guide_ai-code-generation.md\":\"sKTns30w\",\"guide_audit-compliance.md\":\"-wZEc6pt\",\"guide_capabilities.md\":\"0w9HYsTU\",\"guide_cli_commands.md\":\"BGitH93C\",\"guide_commands.md\":\"BLtNYDJa\",\"guide_contributing.md\":\"BZvvPdPI\",\"guide_examples.md\":\"Bt0J0Xwj\",\"guide_formatting.md\":\"BIcHnXgx\",\"guide_getting-started-packages.md\":\"Dd9Wg98j\",\"guide_getting-started.md\":\"ExEQ5ylv\",\"guide_interop-overloads.md\":\"D-3IUfl-\",\"guide_language-overview.md\":\"CrBKH9ia\",\"guide_lsp-code-actions.md\":\"qIDYbolg\",\"guide_lsp-tutorial.md\":\"CaTCrVPF\",\"guide_package-management_manifest-reference.md\":\"CA2s7laZ\",\"guide_package-management_overview.md\":\"2Z9IMAmJ\",\"guide_pii-compliance.md\":\"CQmq-UAy\",\"guide_quickstart.md\":\"_yd4QSXk\",\"guide_truffle-quickstart.md\":\"B9Olssrg\",\"index.md\":\"B6O2FXoC\",\"java25-compatibility.md\":\"Bt_QsLV4\",\"language_workflow.md\":\"DjavpKtt\",\"migration-guide.md\":\"Dawg27uf\",\"native-build-guide.md\":\"BLzGaiax\",\"native-image_build-guide.md\":\"CpjZnOr9\",\"native-image_limitations.md\":\"zHp-FAzG\",\"native-image_performance-comparison.md\":\"_X8Yj_r0\",\"native-image_readme.md\":\"8k_pD_35\",\"native-image_troubleshooting.md\":\"fkOy1U7O\",\"operations.md\":\"B63Kg8_8\",\"operations_configuration.md\":\"DS96Z88D\",\"operations_deployment.md\":\"D8967GHj\",\"operations_lsp-monitoring.md\":\"kGwox_P0\",\"operations_rollback.md\":\"BRdBvO73\",\"operations_troubleshooting.md\":\"CPGTwKd-\",\"p0-4-completion-summary.md\":\"BKJH7bPF\",\"performance-comparison-charts.md\":\"BmL-h3JC\",\"performance-guide.md\":\"DRZ0N8-o\",\"performance-improvement-roadmap.md\":\"Cu5F8qIt\",\"performance-optimization.md\":\"Be3hE-Ax\",\"performance-regression-monitoring.md\":\"CMsysdlw\",\"performance.md\":\"CN30-jwG\",\"phase0_determinism-contract.md\":\"BksgZ75A\",\"phase0_idempotency-helpers.md\":\"COSI9HRx\",\"phase0_pii-logging-policy.md\":\"BS1gfx3F\",\"phase0_readme.md\":\"B5Ib4xxT\",\"phase0_tamper-evident-audit.md\":\"BBrqVw6u\",\"phase1-user-guide.md\":\"PZb7u1Uk\",\"publishing-guide.md\":\"BlF59Hfz\",\"readme.md\":\"CY5Lhu8s\",\"reference_asm-emitter.md\":\"D6rKYQWD\",\"reference_effect-inference-algorithm.md\":\"Dl8fA7nC\",\"reference_effects-capabilities.md\":\"C1YHTPFx\",\"reference_effects.md\":\"CqQiffue\",\"reference_generics.md\":\"DVdbd2sF\",\"reference_jvm-interop.md\":\"DExS3b4v\",\"reference_lambdas.md\":\"Dm_CVDdF\",\"reference_language-specification.md\":\"CHObGSzA\",\"reference_modules.md\":\"CT9_HBUH\",\"reference_native.md\":\"_3X58hKu\",\"reference_pii-taint-analysis.md\":\"B7chE1N_\",\"reference_production-builds.md\":\"GQU4aQ76\",\"reference_runtime-api.md\":\"BDtl3Pn5\",\"reference_stdlib-api.md\":\"De0TooyD\",\"reference_syntax.md\":\"C8HXmQ0O\",\"reference_truffle.md\":\"Czyrxje0\",\"reference_types.md\":\"DYn-fglz\",\"repository-infrastructure.md\":\"BGnhIcdD\",\"runtime_backend-comparison.md\":\"BBXrjxPT\",\"runtime_determinism-contract.md\":\"DYvxgeKt\",\"runtime_retry-semantics.md\":\"BbveN_BY\",\"runtime_truffle-backend.md\":\"DVUEbRm2\",\"tech-effect-inference-design.md\":\"iUj1JwO8\",\"testing.md\":\"DQ-vCAFG\",\"truffle-architecture.md\":\"XvsAP0qq\",\"truffle-backend-limitations.md\":\"D8HHZylJ\",\"truffle-performance-benchmarks.md\":\"ByVLZONC\",\"truffle-performance-comparison.md\":\"CGVqtjWg\",\"user-guide-effect-polymorphism.md\":\"CLCwhjUU\",\"workstreams_23a66060-6637-4a38-b1d8-b5ab76f4f876_operations-log.md\":\"DqbhzKOv\",\"workstreams_342f9631-da63-4044-9b62-bedb1a4a378c_operations-log.md\":\"4fF1lJvO\",\"workstreams_428f8b23-2db0-458e-9be2-a95e310be030_operations-log.md\":\"Dflgyj6D\",\"workstreams_428f8b23-2db0-458e-9be2-a95e310be030_verification_verification.md\":\"B9b4Gp86\",\"workstreams_429d03ce-6581-4279-9bc6-a71307e63ca4_operations-log.md\":\"BKeOeMa6\",\"workstreams_4be2e593-2955-4539-aa3d-7b4c61f4e1a9_operations-log.md\":\"BjHuRelc\",\"workstreams_68daace8-e645-47a7-ae0b-5d7cd4cf8dab_operations-log.md\":\"DIxtWDyE\",\"workstreams_6fd5b600-0163-4efc-bd07-43e517b15587_operations-log.md\":\"376wJ2_T\",\"workstreams_714da447-6391-4864-b689-c03c45b64a72_operations-log.md\":\"C1c1mSeQ\",\"workstreams_714da447-6391-4864-b689-c03c45b64a72_verification.md\":\"C6I6mJmj\",\"workstreams_7f046db7-ce07-4a1a-bafc-00a943de6bbc_operations-log.md\":\"bTo0JAAY\",\"workstreams_7f046db7-ce07-4a1a-bafc-00a943de6bbc_verification.md\":\"CYleL-nQ\",\"workstreams_88f1c8c5-db32-4a9e-a17f-59141b667bb6_operations-log.md\":\"zFXdkA2O\",\"workstreams_88f1c8c5-db32-4a9e-a17f-59141b667bb6_verification_verification.md\":\"BseWxpZU\",\"workstreams_8bd39f4c-e221-4ab5-b4b4-689662fee5ea_operations-log.md\":\"B30SpGE5\",\"workstreams_924f1bef-5079-4e33-bab9-dbbdeab8d9d5_operations-log.md\":\"BRtZwZsQ\",\"workstreams_9bb5de4d-5ea5-4863-8358-055976d96818_operations-log.md\":\"B2m9ImFH\",\"workstreams_9f3bbb1d-4240-447e-94c1-60a73bc0d943_operations-log.md\":\"40DPm_OB\",\"workstreams_a7b1d981-e5b4-4f3f-bbfe-0a593879e649_operations-log.md\":\"tUmhx1CS\",\"workstreams_aee766ca-7a37-4d42-87ad-4aea5cccc281_operations-log.md\":\"DH_Urdtb\",\"workstreams_aster-asm-emitter-refactor_operations-log.md\":\"BmH7yL-K\",\"workstreams_aster-idea-review_operations-log.md\":\"Bd4YCzKT\",\"workstreams_b7decd69-7066-4080-a794-a6f6c400a846_operations-log.md\":\"Ca-3qWp6\",\"workstreams_context-integration-test_operations-log.md\":\"Cw6rnXSA\",\"workstreams_e1cacc8c-9fcd-4759-b20a-23faa3d0fd86_operations-log.md\":\"BR4hjPMT\",\"workstreams_ef32967d-5391-4a6c-8805-9d942d214c13_operations-log.md\":\"BaBewtGQ\",\"workstreams_error-message-improvement_operations-log.md\":\"BwTb4wCM\",\"workstreams_error-message-improvement_verification.md\":\"D4IHXh_V\",\"workstreams_fadc4c83-e616-4654-b224-5cb3873b097a_operations-log.md\":\"C-wfj6T-\",\"workstreams_function-return-type-inference_operations-log.md\":\"CRrrejXN\",\"workstreams_github-actions-optimization_implementation.md\":\"D-xbYPd6\",\"workstreams_github-actions-optimization_verification.md\":\"Bf3eYlyv\",\"workstreams_github-folder-audit_operations-log.md\":\"Bgn7mHD8\",\"workstreams_golden-test-expansion_operations-log.md\":\"DJ6Dmn7z\",\"workstreams_golden-test-expansion_verification.md\":\"Blgp2Qd2\",\"workstreams_java-core-lowering_operations-log.md\":\"BWkGMQCN\",\"workstreams_lsp-coverage_operations-log.md\":\"BtvSef_S\",\"workstreams_native-cli_jar-hotswap-implementation.md\":\"nEcwLSQw\",\"workstreams_native-cli_operations-log.md\":\"BojbyEt5\",\"workstreams_native-cli_parser-consistency-report.md\":\"gc1PTTHr\",\"workstreams_native-cli_verification_verification.md\":\"CFV494mH\",\"workstreams_native-cli_vscode-typescript-compiler-integration.md\":\"CKPDqqo9\",\"workstreams_native-image-review_operations-log.md\":\"acFv2SZ9\",\"workstreams_p0-4_operations-log.md\":\"HfKffxcq\",\"workstreams_p0-5_operations-log.md\":\"DDXOCsYe\",\"workstreams_p1-5_operations-log.md\":\"lndeopTM\",\"workstreams_p1_operations-log.md\":\"BGjMPVNH\",\"workstreams_p2-1_operations-log.md\":\"kaVKwhSp\",\"workstreams_p2-1_verification.md\":\"BncIHJHD\",\"workstreams_p2-2_operations-log.md\":\"CfrodXxv\",\"workstreams_p2-4_implementation_structured-logging-usage.md\":\"CaoZ9r7n\",\"workstreams_p2-4_operations-log.md\":\"B20-50o_\",\"workstreams_p2-4_verification_structured-logging-verification.md\":\"BNeAjwV2\",\"workstreams_p2-5_operations-log.md\":\"C5XZ6AfX\",\"workstreams_p2-6_operations-log.md\":\"CvVuOp-q\",\"workstreams_p2-6_verification.md\":\"CGs8i2vs\",\"workstreams_p2-7-task6_operations-log.md\":\"DeKHUJwq\",\"workstreams_p2-truffle-comparative-benchmark_operations-log.md\":\"Brh4E1Zn\",\"workstreams_p3-1_operations-log.md\":\"DseqUc9p\",\"workstreams_p3-3_operations-log.md\":\"PWYbcZTK\",\"workstreams_p4-0.1_operations-log.md\":\"DPPEJGmm\",\"workstreams_p4-0.1_verification.md\":\"DdFU6q0z\",\"workstreams_p4-0.4_operations-log.md\":\"D-SNz7C_\",\"workstreams_p4-0.4_verification.md\":\"BujuNssP\",\"workstreams_p4-0_index.md\":\"344r-8eD\",\"workstreams_p4-0_operations-log.md\":\"D3KwpiMN\",\"workstreams_p4-0_readme.md\":\"Cr8ryRvi\",\"workstreams_p4-2.6_implementation_report.md\":\"U9XIM3NZ\",\"workstreams_p4-2.6_operations-log.md\":\"uLCeyEZf\",\"workstreams_p4-2_annotation-semantics.md\":\"BpY9KrFd\",\"workstreams_p4-2_index.md\":\"8fYgiRLU\",\"workstreams_p4-2_operations-log.md\":\"CqwZbBzT\",\"workstreams_p4-2_readme.md\":\"BNKCQ8x9\",\"workstreams_p4-batch2_operations-log.md\":\"CyG4plmz\",\"workstreams_p4-batch5_operations-log.md\":\"CMU7-dy9\",\"workstreams_p4-batch5_research_failure-analysis.md\":\"0dO0in7a\",\"workstreams_phase-0-foundation-hardening_operations-log.md\":\"BJDrYnZX\",\"workstreams_phase-3.8_api-changes.md\":\"C4H1cjz7\",\"workstreams_phase-3.8_deployment-checklist.md\":\"Bm3xqMoU\",\"workstreams_phase-3.8_index.md\":\"BewpN0ZJ\",\"workstreams_phase-3.8_monitoring-guide.md\":\"BLDFDae0\",\"workstreams_phase-3.8_performance-test.md\":\"Cw_w3Y21\",\"workstreams_phase-3.8_readme.md\":\"BqE9JPRg\",\"workstreams_phase0-feature-docs_implementation.md\":\"CDeAzj0v\",\"workstreams_phase0-feature-docs_operations-log.md\":\"C680i2aJ\",\"workstreams_phase4.5-priority2_operations-log.md\":\"CKDeG3OP\",\"workstreams_phase7_operations-log.md\":\"DCZE10iu\",\"workstreams_quarkus-policy-api_operations-log.md\":\"zi6cvtxn\",\"workstreams_remaining-examples_implementation_batch-01.md\":\"BbMD71Ni\",\"workstreams_remaining-examples_implementation_batch-02.md\":\"Du5mUMj4\",\"workstreams_remaining-examples_implementation_batch-03.md\":\"B6uFu97O\",\"workstreams_setup-env-action_operations-log.md\":\"xbjmm1BO\",\"workstreams_span-from-sources-fix_operations-log.md\":\"uFEh8cNx\",\"workstreams_task4-emitter_operations-log.md\":\"EpjQS7KO\",\"workstreams_task6-domain-library_operations-log.md\":\"P0JrxsQP\",\"workstreams_task8-compensation_operations-log.md\":\"kpa9l4lj\",\"workstreams_tasks-11-13_implementation.md\":\"D3cNe9US\",\"workstreams_tasks-2-5_operations-log.md\":\"Cd0yWJpd\",\"workstreams_truffle-phase0_operations-log.md\":\"Bayaeg7M\",\"workstreams_truffle-phase1_operations-log.md\":\"OXora7b2\",\"workstreams_truffle-phase2_operations-log.md\":\"B7pBNZPQ\",\"workstreams_truffle-phase2_variable-flow-analysis.md\":\"DzuGttmw\",\"workstreams_truffle-phase2_verification.md\":\"BOHcBCFK\",\"workstreams_truffle-quickstart_operations-log.md\":\"DAnBsxbN\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Aster Language\",\"description\":\"A pragmatic, safe, fast language with a human CNL surface\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"/logo.svg\",\"nav\":[{\"text\":\"Guide\",\"link\":\"/guide/getting-started\"},{\"text\":\"Formatting\",\"link\":\"/guide/formatting\"},{\"text\":\"Reference\",\"link\":\"/reference/syntax\"},{\"text\":\"API\",\"link\":\"/api/overview\"},{\"text\":\"GitHub\",\"link\":\"https://github.com/wontlost-ltd/aster-lang\"}],\"sidebar\":{\"/guide/\":[{\"text\":\"Guide\",\"items\":[{\"text\":\"Getting Started\",\"link\":\"/guide/getting-started\"},{\"text\":\"Language Overview\",\"link\":\"/guide/language-overview\"},{\"text\":\"Examples\",\"link\":\"/guide/examples\"},{\"text\":\"Formatting, LSP & CLI\",\"link\":\"/guide/formatting\"},{\"text\":\"JVM Interop Overloads\",\"link\":\"/guide/interop-overloads\"},{\"text\":\"Contributing\",\"link\":\"/guide/contributing\"}]},{\"text\":\"Package Management\",\"items\":[{\"text\":\"包管理快速入门\",\"link\":\"/guide/getting-started-packages\"},{\"text\":\"包管理系统概述\",\"link\":\"/guide/package-management/overview\"},{\"text\":\"manifest.json 参考\",\"link\":\"/guide/package-management/manifest-reference\"},{\"text\":\"CLI 命令参考\",\"link\":\"/guide/cli/commands\"}]}],\"/reference/\":[{\"text\":\"Reference\",\"items\":[{\"text\":\"Syntax\",\"link\":\"/reference/syntax\"},{\"text\":\"Types\",\"link\":\"/reference/types\"},{\"text\":\"Effects\",\"link\":\"/reference/effects\"}]}],\"/api/\":[{\"text\":\"API\",\"items\":[{\"text\":\"Overview\",\"link\":\"/api/overview\"},{\"text\":\"Canonicalizer\",\"link\":\"/api/canonicalizer\"},{\"text\":\"Lexer\",\"link\":\"/api/lexer\"},{\"text\":\"Parser\",\"link\":\"/api/parser\"},{\"text\":\"Core IR\",\"link\":\"/api/core\"},{\"text\":\"Generated (TypeDoc)\",\"link\":\"/api/typedoc/\"}]}]},\"search\":{\"provider\":\"local\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/wontlost-ltd/aster-lang\"}],\"footer\":{\"message\":\"Released under the MIT License.\",\"copyright\":\"Copyright © 2025 Aster Language Team\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false,\"additionalConfig\":{}}");</script>
    
  </body>
</html>