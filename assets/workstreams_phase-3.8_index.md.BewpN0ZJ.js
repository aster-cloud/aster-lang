import{_ as a,c as i,o as l,aj as t}from"./chunks/framework.Bz2R-749.js";const g=JSON.parse('{"title":"Phase 3.8: å¼‚å¸¸å“åº”è‡ªåŠ¨åŒ– - ä»£è¡¨æ€§æ ·æœ¬æ”¯æŒ","description":"","frontmatter":{},"headers":[],"relativePath":"workstreams/phase-3.8/index.md","filePath":"workstreams/phase-3.8/index.md"}'),n={name:"workstreams/phase-3.8/index.md"};function h(e,s,r,k,p,d){return l(),i("div",null,[...s[0]||(s[0]=[t(`<h1 id="phase-3-8-å¼‚å¸¸å“åº”è‡ªåŠ¨åŒ–-ä»£è¡¨æ€§æ ·æœ¬æ”¯æŒ" tabindex="-1">Phase 3.8: å¼‚å¸¸å“åº”è‡ªåŠ¨åŒ– - ä»£è¡¨æ€§æ ·æœ¬æ”¯æŒ <a class="header-anchor" href="#phase-3-8-å¼‚å¸¸å“åº”è‡ªåŠ¨åŒ–-ä»£è¡¨æ€§æ ·æœ¬æ”¯æŒ" aria-label="Permalink to â€œPhase 3.8: å¼‚å¸¸å“åº”è‡ªåŠ¨åŒ– - ä»£è¡¨æ€§æ ·æœ¬æ”¯æŒâ€">â€‹</a></h1><p><strong>å®Œæˆæ—¶é—´</strong>: 2025-11-11 <strong>çŠ¶æ€</strong>: âœ… å·²å®Œæˆ <strong>æµ‹è¯•é€šè¿‡ç‡</strong>: 285/285 (100%)</p><hr><h2 id="æ¦‚è¿°" tabindex="-1">æ¦‚è¿° <a class="header-anchor" href="#æ¦‚è¿°" aria-label="Permalink to â€œæ¦‚è¿°â€">â€‹</a></h2><p>Phase 3.8 ä¸ºå¼‚å¸¸å“åº”è‡ªåŠ¨åŒ–å¢åŠ äº†ä»£è¡¨æ€§æ ·æœ¬æ”¯æŒï¼Œå®ç°äº†ä»å¼‚å¸¸æ£€æµ‹åˆ°è‡ªåŠ¨éªŒè¯çš„å®Œæ•´æ•°æ®é“¾è·¯ã€‚</p><h3 id="æ ¸å¿ƒåŠŸèƒ½" tabindex="-1">æ ¸å¿ƒåŠŸèƒ½ <a class="header-anchor" href="#æ ¸å¿ƒåŠŸèƒ½" aria-label="Permalink to â€œæ ¸å¿ƒåŠŸèƒ½â€">â€‹</a></h3><ol><li><strong>ä»£è¡¨æ€§æ ·æœ¬æ•è·</strong> - åœ¨å¼‚å¸¸æ£€æµ‹æ—¶è‡ªåŠ¨æ•è·å¤±è´¥ workflow å®ä¾‹</li><li><strong>Payload è‡ªåŠ¨æ„å»º</strong> - åŸºäº sampleWorkflowId æ„å»ºéªŒè¯åŠ¨ä½œ payload</li><li><strong>Replay éªŒè¯æ¥å£</strong> - æ”¯æŒåŸºäº workflowId çš„ replay éªŒè¯</li></ol><h3 id="å…³é”®ç‰¹æ€§" tabindex="-1">å…³é”®ç‰¹æ€§ <a class="header-anchor" href="#å…³é”®ç‰¹æ€§" aria-label="Permalink to â€œå…³é”®ç‰¹æ€§â€">â€‹</a></h3><ul><li>âœ… <strong>æ•°æ®åº“è¿ç§»</strong>: æ–°å¢ <code>sample_workflow_id</code> åˆ—å’Œç¨€ç–ç´¢å¼•</li><li>âœ… <strong>JOIN LATERAL ä¼˜åŒ–</strong>: é«˜æ•ˆæŸ¥è¯¢å¤±è´¥ workflow æ ·æœ¬</li><li>âœ… <strong>å®Œå…¨å‘åå…¼å®¹</strong>: æ–°å­—æ®µå¯é€‰ï¼Œä¸å½±å“è€å®¢æˆ·ç«¯</li><li>âœ… <strong>é™çº§å¤„ç†</strong>: sampleWorkflowId ä¸º null æ—¶è‡ªåŠ¨é™çº§</li><li>âœ… <strong>å…¨é¢æµ‹è¯•è¦†ç›–</strong>: 23 ä¸ªæ–°å¢æµ‹è¯•ç”¨ä¾‹</li></ul><hr><h2 id="å¿«é€Ÿå¯¼èˆª" tabindex="-1">å¿«é€Ÿå¯¼èˆª <a class="header-anchor" href="#å¿«é€Ÿå¯¼èˆª" aria-label="Permalink to â€œå¿«é€Ÿå¯¼èˆªâ€">â€‹</a></h2><h3 id="ğŸ“‹-éƒ¨ç½²ä¸è¿ç»´" tabindex="-1">ğŸ“‹ éƒ¨ç½²ä¸è¿ç»´ <a class="header-anchor" href="#ğŸ“‹-éƒ¨ç½²ä¸è¿ç»´" aria-label="Permalink to â€œğŸ“‹ éƒ¨ç½²ä¸è¿ç»´â€">â€‹</a></h3><ul><li><strong><a href="./deployment-checklist.html">éƒ¨ç½²æ£€æŸ¥æ¸…å•</a></strong> - Staging éªŒè¯ã€è¿ç§»è„šæœ¬ã€å›æ»šæ–¹æ¡ˆã€ç›‘æ§æŒ‡æ ‡</li><li><strong><a href="./monitoring-guide.html">ç›‘æ§è¿ç»´æ‰‹å†Œ</a></strong> - 5 ä¸ªæ ¸å¿ƒæŒ‡æ ‡ã€Grafana é…ç½®ã€æ•…éšœæ’æŸ¥</li></ul><h3 id="ğŸ“–-å¼€å‘é›†æˆ" tabindex="-1">ğŸ“– å¼€å‘é›†æˆ <a class="header-anchor" href="#ğŸ“–-å¼€å‘é›†æˆ" aria-label="Permalink to â€œğŸ“– å¼€å‘é›†æˆâ€">â€‹</a></h3><ul><li><strong><a href="./api-changes.html">API å˜æ›´æ–‡æ¡£</a></strong> - <code>AnomalyReportDTO.sampleWorkflowId</code> å­—æ®µã€ä½¿ç”¨ç¤ºä¾‹ã€FAQ</li><li><strong><a href="./performance-test.html">æ€§èƒ½æµ‹è¯•æŒ‡å—</a></strong> - æµ‹è¯•è„šæœ¬ã€åŸºå‡†æ•°æ®ã€ä¼˜åŒ–å»ºè®®</li></ul><h3 id="ğŸ“Š-æ€»ç»“æŠ¥å‘Š" tabindex="-1">ğŸ“Š æ€»ç»“æŠ¥å‘Š <a class="header-anchor" href="#ğŸ“Š-æ€»ç»“æŠ¥å‘Š" aria-label="Permalink to â€œğŸ“Š æ€»ç»“æŠ¥å‘Šâ€">â€‹</a></h3><ul><li><strong><a href="./README.html">å®æ–½æ€»ç»“</a></strong> - å®Œæ•´çš„æ”¹è¿›æªæ–½æ€»ç»“ã€æˆåŠŸæŒ‡æ ‡ã€åç»­å»ºè®®</li></ul><hr><h2 id="æ ¸å¿ƒæ”¹åŠ¨" tabindex="-1">æ ¸å¿ƒæ”¹åŠ¨ <a class="header-anchor" href="#æ ¸å¿ƒæ”¹åŠ¨" aria-label="Permalink to â€œæ ¸å¿ƒæ”¹åŠ¨â€">â€‹</a></h2><h3 id="æ•°æ®åº“å˜æ›´" tabindex="-1">æ•°æ®åº“å˜æ›´ <a class="header-anchor" href="#æ•°æ®åº“å˜æ›´" aria-label="Permalink to â€œæ•°æ®åº“å˜æ›´â€">â€‹</a></h3><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- æ–°å¢åˆ—</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> anomaly_reports</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ADD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> COLUMN sample_workflow_id UUID;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- æ–°å¢ç¨€ç–ç´¢å¼•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> INDEX</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> idx_anomaly_reports_sample_workflow</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> anomaly_reports(sample_workflow_id)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sample_workflow_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">IS NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p><strong>å›æ»šè„šæœ¬</strong>: <code>quarkus-policy-api/src/main/resources/db/migration/ROLLBACK_V3.8.0.sql</code></p><h3 id="api-å˜æ›´" tabindex="-1">API å˜æ›´ <a class="header-anchor" href="#api-å˜æ›´" aria-label="Permalink to â€œAPI å˜æ›´â€">â€‹</a></h3><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AnomalyReportDTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Phase 3.8 æ–°å¢å­—æ®µ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UUID sampleWorkflowId;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å¯èƒ½ä¸º null</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>å½±å“ç«¯ç‚¹</strong>:</p><ul><li><code>GET /api/analytics/anomalies</code> - å“åº”åŒ…å« sampleWorkflowId</li><li><code>POST /api/anomalies/{id}/verify</code> - è‡ªåŠ¨ä½¿ç”¨ sampleWorkflowId æ„å»º payload</li></ul><hr><h2 id="ç›‘æ§æŒ‡æ ‡" tabindex="-1">ç›‘æ§æŒ‡æ ‡ <a class="header-anchor" href="#ç›‘æ§æŒ‡æ ‡" aria-label="Permalink to â€œç›‘æ§æŒ‡æ ‡â€">â€‹</a></h2><h3 id="ğŸ”´-å…³é”®æŒ‡æ ‡" tabindex="-1">ğŸ”´ å…³é”®æŒ‡æ ‡ <a class="header-anchor" href="#ğŸ”´-å…³é”®æŒ‡æ ‡" aria-label="Permalink to â€œğŸ”´ å…³é”®æŒ‡æ ‡â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>æŒ‡æ ‡</th><th>ç›®æ ‡å€¼</th><th>å‘Šè­¦é˜ˆå€¼</th></tr></thead><tbody><tr><td>sampleWorkflowId æ•è·ç‡</td><td>&gt; 95%</td><td>&lt; 80%</td></tr><tr><td>Replay éªŒè¯æˆåŠŸç‡</td><td>&gt; 85%</td><td>&lt; 70%</td></tr><tr><td>å¼‚å¸¸æ£€æµ‹æŸ¥è¯¢æ—¶é—´</td><td>&lt; 300ms</td><td>&gt; 500ms</td></tr></tbody></table><h3 id="ğŸŸ¡-é‡è¦æŒ‡æ ‡" tabindex="-1">ğŸŸ¡ é‡è¦æŒ‡æ ‡ <a class="header-anchor" href="#ğŸŸ¡-é‡è¦æŒ‡æ ‡" aria-label="Permalink to â€œğŸŸ¡ é‡è¦æŒ‡æ ‡â€">â€‹</a></h3><table tabindex="0"><thead><tr><th>æŒ‡æ ‡</th><th>ç›®æ ‡å€¼</th><th>å‘Šè­¦é˜ˆå€¼</th></tr></thead><tbody><tr><td>Replay è¶…æ—¶ç‡</td><td>&lt; 5%</td><td>&gt; 10%</td></tr><tr><td>Payload æ„å»ºæˆåŠŸç‡</td><td>&gt; 95%</td><td>&lt; 80%</td></tr></tbody></table><p><strong>è¯¦ç»†ç›‘æ§é…ç½®</strong>: å‚è§ <a href="./monitoring-guide.html">ç›‘æ§è¿ç»´æ‰‹å†Œ</a></p><hr><h2 id="æµ‹è¯•è¦†ç›–" tabindex="-1">æµ‹è¯•è¦†ç›– <a class="header-anchor" href="#æµ‹è¯•è¦†ç›–" aria-label="Permalink to â€œæµ‹è¯•è¦†ç›–â€">â€‹</a></h2><h3 id="å•å…ƒæµ‹è¯•-19-ä¸ª" tabindex="-1">å•å…ƒæµ‹è¯•ï¼ˆ19 ä¸ªï¼‰ <a class="header-anchor" href="#å•å…ƒæµ‹è¯•-19-ä¸ª" aria-label="Permalink to â€œå•å…ƒæµ‹è¯•ï¼ˆ19 ä¸ªï¼‰â€">â€‹</a></h3><ul><li><strong>PolicyAnalyticsServiceTest</strong> (5 tests) - å¼‚å¸¸æ£€æµ‹ä¸ sampleWorkflowId æ•è·</li><li><strong>AnomalyWorkflowServiceTest</strong> (8 tests, 3 new) - Payload æ„å»ºé€»è¾‘</li><li><strong>WorkflowSchedulerServiceTest</strong> (6 tests) - Replay éªŒè¯æ¥å£</li></ul><h3 id="é›†æˆæµ‹è¯•-4-ä¸ª" tabindex="-1">é›†æˆæµ‹è¯•ï¼ˆ4 ä¸ªï¼‰ <a class="header-anchor" href="#é›†æˆæµ‹è¯•-4-ä¸ª" aria-label="Permalink to â€œé›†æˆæµ‹è¯•ï¼ˆ4 ä¸ªï¼‰â€">â€‹</a></h3><ul><li><strong>AnomalyReplayVerificationIntegrationTest</strong> (4 tests) - ç«¯åˆ°ç«¯æ•°æ®é“¾è·¯</li></ul><p><strong>æµ‹è¯•ç»“æœ</strong>: 285/285 é€šè¿‡ (100% æˆåŠŸç‡)</p><hr><h2 id="éƒ¨ç½²å‡†å¤‡æ¸…å•" tabindex="-1">éƒ¨ç½²å‡†å¤‡æ¸…å• <a class="header-anchor" href="#éƒ¨ç½²å‡†å¤‡æ¸…å•" aria-label="Permalink to â€œéƒ¨ç½²å‡†å¤‡æ¸…å•â€">â€‹</a></h2><h3 id="ç«‹å³è¡ŒåŠ¨-æœ¬å‘¨å†…" tabindex="-1">ç«‹å³è¡ŒåŠ¨ï¼ˆæœ¬å‘¨å†…ï¼‰ <a class="header-anchor" href="#ç«‹å³è¡ŒåŠ¨-æœ¬å‘¨å†…" aria-label="Permalink to â€œç«‹å³è¡ŒåŠ¨ï¼ˆæœ¬å‘¨å†…ï¼‰â€">â€‹</a></h3><ul><li>[ ] Staging ç¯å¢ƒéªŒè¯</li><li>[ ] é…ç½®ç›‘æ§ä»ªè¡¨æ¿</li><li>[ ] å›¢é˜ŸåŸ¹è®­</li></ul><h3 id="çŸ­æœŸä¼˜åŒ–-éƒ¨ç½²å-1-2-å‘¨" tabindex="-1">çŸ­æœŸä¼˜åŒ–ï¼ˆéƒ¨ç½²å 1-2 å‘¨ï¼‰ <a class="header-anchor" href="#çŸ­æœŸä¼˜åŒ–-éƒ¨ç½²å-1-2-å‘¨" aria-label="Permalink to â€œçŸ­æœŸä¼˜åŒ–ï¼ˆéƒ¨ç½²å 1-2 å‘¨ï¼‰â€">â€‹</a></h3><ul><li>[ ] æ€§èƒ½æµ‹è¯•</li><li>[ ] ç›‘æ§æ•°æ®åˆ†æ</li></ul><h3 id="é•¿æœŸä¼˜åŒ–-éƒ¨ç½²å-1-ä¸ªæœˆ" tabindex="-1">é•¿æœŸä¼˜åŒ–ï¼ˆéƒ¨ç½²å 1 ä¸ªæœˆï¼‰ <a class="header-anchor" href="#é•¿æœŸä¼˜åŒ–-éƒ¨ç½²å-1-ä¸ªæœˆ" aria-label="Permalink to â€œé•¿æœŸä¼˜åŒ–ï¼ˆéƒ¨ç½²å 1 ä¸ªæœˆï¼‰â€">â€‹</a></h3><ul><li>[ ] æ€§èƒ½ä¼˜åŒ–ï¼ˆå¦‚éœ€è¦ï¼‰</li><li>[ ] æ”¶é›†ç”¨æˆ·åé¦ˆ</li></ul><hr><h2 id="æˆåŠŸæ ‡å‡†" tabindex="-1">æˆåŠŸæ ‡å‡† <a class="header-anchor" href="#æˆåŠŸæ ‡å‡†" aria-label="Permalink to â€œæˆåŠŸæ ‡å‡†â€">â€‹</a></h2><h3 id="éƒ¨ç½²æˆåŠŸ" tabindex="-1">éƒ¨ç½²æˆåŠŸ <a class="header-anchor" href="#éƒ¨ç½²æˆåŠŸ" aria-label="Permalink to â€œéƒ¨ç½²æˆåŠŸâ€">â€‹</a></h3><ul><li>âœ… Staging ç¯å¢ƒéªŒè¯é€šè¿‡</li><li>âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ˆ285/285ï¼‰</li><li>âœ… ç›‘æ§é…ç½®å®Œæˆ</li><li>âœ… å›¢é˜ŸåŸ¹è®­å®Œæˆ</li></ul><h3 id="è¿è¡ŒæˆåŠŸ-éƒ¨ç½²å-2-å‘¨" tabindex="-1">è¿è¡ŒæˆåŠŸï¼ˆéƒ¨ç½²å 2 å‘¨ï¼‰ <a class="header-anchor" href="#è¿è¡ŒæˆåŠŸ-éƒ¨ç½²å-2-å‘¨" aria-label="Permalink to â€œè¿è¡ŒæˆåŠŸï¼ˆéƒ¨ç½²å 2 å‘¨ï¼‰â€">â€‹</a></h3><ul><li>âœ… sampleWorkflowId æ•è·ç‡ &gt; 80%</li><li>âœ… Replay éªŒè¯æˆåŠŸç‡ &gt; 70%</li><li>âœ… Replay è¶…æ—¶ç‡ &lt; 10%</li><li>âœ… å¼‚å¸¸æ£€æµ‹æŸ¥è¯¢æ—¶é—´ &lt; 500ms</li><li>âœ… æ— é‡å¤§ç”Ÿäº§äº‹æ•…</li></ul><hr><h2 id="æ–‡æ¡£ç´¢å¼•" tabindex="-1">æ–‡æ¡£ç´¢å¼• <a class="header-anchor" href="#æ–‡æ¡£ç´¢å¼•" aria-label="Permalink to â€œæ–‡æ¡£ç´¢å¼•â€">â€‹</a></h2><table tabindex="0"><thead><tr><th>æ–‡æ¡£</th><th>ç”¨é€”</th><th>ç›®æ ‡è¯»è€…</th></tr></thead><tbody><tr><td><a href="./deployment-checklist.html">éƒ¨ç½²æ£€æŸ¥æ¸…å•</a></td><td>éƒ¨ç½²æ‰§è¡Œ</td><td>è¿ç»´ã€DBA</td></tr><tr><td><a href="./api-changes.html">API å˜æ›´æ–‡æ¡£</a></td><td>API é›†æˆ</td><td>å¼€å‘è€…ã€API ä½¿ç”¨è€…</td></tr><tr><td><a href="./monitoring-guide.html">ç›‘æ§è¿ç»´æ‰‹å†Œ</a></td><td>ç›‘æ§é…ç½®</td><td>è¿ç»´ã€SRE</td></tr><tr><td><a href="./performance-test.html">æ€§èƒ½æµ‹è¯•æŒ‡å—</a></td><td>æ€§èƒ½æµ‹è¯•</td><td>å¼€å‘è€…ã€QA</td></tr><tr><td><a href="./README.html">å®æ–½æ€»ç»“</a></td><td>æ•´ä½“æ¦‚è§ˆ</td><td>æ‰€æœ‰è§’è‰²</td></tr></tbody></table><hr><h2 id="æŠ€æœ¯äº®ç‚¹" tabindex="-1">æŠ€æœ¯äº®ç‚¹ <a class="header-anchor" href="#æŠ€æœ¯äº®ç‚¹" aria-label="Permalink to â€œæŠ€æœ¯äº®ç‚¹â€">â€‹</a></h2><h3 id="join-lateral-ä¼˜åŒ–" tabindex="-1">JOIN LATERAL ä¼˜åŒ– <a class="header-anchor" href="#join-lateral-ä¼˜åŒ–" aria-label="Permalink to â€œJOIN LATERAL ä¼˜åŒ–â€">â€‹</a></h3><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    pv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    -- ... å…¶ä»–å­—æ®µ ...</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    sw</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sample_workflow_id</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  -- Phase 3.8 æ–°å¢</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> policy_versions pv</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">LEFT JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> LATERAL (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ws</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">workflow_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sample_workflow_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> workflow_state ws</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ws</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">version_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> pv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    AND</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ws</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;FAILED&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ORDER BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ws</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">started_at</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DESC</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    LIMIT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) sw </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> true;</span></span></code></pre></div><p><strong>ä¼˜åŠ¿</strong>:</p><ul><li>æ¯ä¸ªç­–ç•¥ç‰ˆæœ¬ä»…æŸ¥è¯¢ä¸€ä¸ªæ ·æœ¬</li><li>æŒ‰æ—¶é—´å€’åºï¼Œè·å–æœ€æ–°å¤±è´¥å®ä¾‹</li><li>ä½¿ç”¨ LIMIT 1 ä¼˜åŒ–æ€§èƒ½</li></ul><h3 id="å®Œå…¨å“åº”å¼å®ç°" tabindex="-1">å®Œå…¨å“åº”å¼å®ç° <a class="header-anchor" href="#å®Œå…¨å“åº”å¼å®ç°" aria-label="Permalink to â€œå®Œå…¨å“åº”å¼å®ç°â€">â€‹</a></h3><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Uni</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Void</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> executeReplayVerification</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(AnomalyActionEntity action) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> extractWorkflowId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(action.payload)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">transformToUni</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(workflowId </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            workflowSchedulerService.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">replayWorkflow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(workflowId)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">transformToUni</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            recordVerificationResult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(action.anomalyId, result)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">replaceWith</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Uni.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createFrom</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">voidItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>ä¼˜åŠ¿</strong>:</p><ul><li>æ— é˜»å¡æ“ä½œ</li><li>è‡ªåŠ¨å¼‚å¸¸ä¼ æ’­</li><li>æ”¯æŒè¶…æ—¶æ§åˆ¶</li></ul><hr><h2 id="è”ç³»æ”¯æŒ" tabindex="-1">è”ç³»æ”¯æŒ <a class="header-anchor" href="#è”ç³»æ”¯æŒ" aria-label="Permalink to â€œè”ç³»æ”¯æŒâ€">â€‹</a></h2><p><strong>æŠ€æœ¯é—®é¢˜</strong>: Claude Codeï¼ˆæœ¬æ¬¡å®æ–½ï¼‰ <strong>éƒ¨ç½²æ”¯æŒ</strong>: è¿ç»´å›¢é˜Ÿ <strong>æ€§èƒ½ä¼˜åŒ–</strong>: æ¶æ„å›¢é˜Ÿ</p><hr><p><strong>Phase 3.8 ç°å·²åšå¥½ç”Ÿäº§éƒ¨ç½²å‡†å¤‡ï¼</strong> ğŸš€</p>`,72)])])}const E=a(n,[["render",h]]);export{g as __pageData,E as default};
