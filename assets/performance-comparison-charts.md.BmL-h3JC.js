import{_ as a,c as i,o as n,aj as l}from"./chunks/framework.Bz2R-749.js";const o=JSON.parse('{"title":"Performance Comparison Charts","description":"","frontmatter":{},"headers":[],"relativePath":"performance-comparison-charts.md","filePath":"performance-comparison-charts.md"}'),t={name:"performance-comparison-charts.md"};function e(p,s,h,r,k,d){return n(),i("div",null,[...s[0]||(s[0]=[l(`<h1 id="performance-comparison-charts" tabindex="-1">Performance Comparison Charts <a class="header-anchor" href="#performance-comparison-charts" aria-label="Permalink to “Performance Comparison Charts”">​</a></h1><p>本文档提供 Aster 语言三个后端实现的性能对比可视化图表。</p><h2 id="概览" tabindex="-1">概览 <a class="header-anchor" href="#概览" aria-label="Permalink to “概览”">​</a></h2><p>基于实际基准测试结果（2025-11-03），对比三个后端的执行性能：</p><ul><li><strong>GraalVM JIT</strong>: 优化的 JIT 编译执行</li><li><strong>Truffle Interpreter</strong>: 未优化的 AST 解释执行（估算值）</li><li><strong>Pure Java</strong>: 直接字节码生成（估算值）</li></ul><h2 id="_1-执行时间对比" tabindex="-1">1. 执行时间对比 <a class="header-anchor" href="#_1-执行时间对比" aria-label="Permalink to “1. 执行时间对比”">​</a></h2><h3 id="fibonacci-20-递归算法" tabindex="-1">Fibonacci(20) - 递归算法 <a class="header-anchor" href="#fibonacci-20-递归算法" aria-label="Permalink to “Fibonacci(20) - 递归算法”">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>执行时间 (ms/迭代，越低越好)</span></span>
<span class="line"><span>└───────────────────────────────────────────────┐</span></span>
<span class="line"><span>    Pure Java          ████  15 ms (估算)</span></span>
<span class="line"><span>    GraalVM JIT        █████████  26.25 ms</span></span>
<span class="line"><span>    Truffle Interp.    ███████████████████████████████████████████ 150 ms (估算)</span></span>
<span class="line"><span>                       0        50       100      150      200</span></span></code></pre></div><p><strong>性能比较</strong>:</p><ul><li>GraalVM JIT vs Truffle: <strong>5.7x faster</strong></li><li>Pure Java vs GraalVM JIT: <strong>1.75x faster</strong></li><li>Pure Java vs Truffle: <strong>10x faster</strong></li></ul><h3 id="factorial-12-迭代算法" tabindex="-1">Factorial(12) - 迭代算法 <a class="header-anchor" href="#factorial-12-迭代算法" aria-label="Permalink to “Factorial(12) - 迭代算法”">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>执行时间 (ms/迭代，越低越好)</span></span>
<span class="line"><span>└─────────────────────────────────────────────┐</span></span>
<span class="line"><span>    Pure Java          █  2 ms (估算)</span></span>
<span class="line"><span>    GraalVM JIT        ██  5.0 ms</span></span>
<span class="line"><span>    Truffle Interp.    ████████████  30 ms (估算)</span></span>
<span class="line"><span>                       0    10   20   30   40</span></span></code></pre></div><p><strong>性能比较</strong>:</p><ul><li>GraalVM JIT vs Truffle: <strong>6x faster</strong></li><li>Pure Java vs GraalVM JIT: <strong>2.5x faster</strong></li><li>Pure Java vs Truffle: <strong>15x faster</strong></li></ul><h3 id="quicksort-100-排序算法" tabindex="-1">QuickSort(100) - 排序算法 <a class="header-anchor" href="#quicksort-100-排序算法" aria-label="Permalink to “QuickSort(100) - 排序算法”">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>执行时间 (ms/迭代，越低越好)</span></span>
<span class="line"><span>└───────────────────────────────────────────────┐</span></span>
<span class="line"><span>    Pure Java          ████  50 ms (估算)</span></span>
<span class="line"><span>    GraalVM JIT        ██████████  99.37 ms</span></span>
<span class="line"><span>    Truffle Interp.    ██████████████████████████  500 ms (估算)</span></span>
<span class="line"><span>                       0       200      400      600</span></span></code></pre></div><p><strong>性能比较</strong>:</p><ul><li>GraalVM JIT vs Truffle: <strong>5x faster</strong></li><li>Pure Java vs GraalVM JIT: <strong>2x faster</strong></li><li>Pure Java vs Truffle: <strong>10x faster</strong></li></ul><h3 id="binary-tree-traversal-15-树遍历" tabindex="-1">Binary Tree Traversal(15) - 树遍历 <a class="header-anchor" href="#binary-tree-traversal-15-树遍历" aria-label="Permalink to “Binary Tree Traversal(15) - 树遍历”">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>执行时间 (ms/迭代，越低越好)</span></span>
<span class="line"><span>└──────────────────────────────────────────────┐</span></span>
<span class="line"><span>    Pure Java          █  0.05 ms (估算)</span></span>
<span class="line"><span>    GraalVM JIT        █  0.074 ms</span></span>
<span class="line"><span>    Truffle Interp.    ██████████  0.5 ms (估算)</span></span>
<span class="line"><span>                       0    0.2   0.4   0.6</span></span></code></pre></div><p><strong>性能比较</strong>:</p><ul><li>GraalVM JIT vs Truffle: <strong>6.8x faster</strong></li><li>Pure Java vs GraalVM JIT: <strong>1.5x faster</strong></li><li>Pure Java vs Truffle: <strong>10x faster</strong></li></ul><h3 id="string-operations-字符串处理" tabindex="-1">String Operations - 字符串处理 <a class="header-anchor" href="#string-operations-字符串处理" aria-label="Permalink to “String Operations - 字符串处理”">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>执行时间 (ms/迭代，越低越好)</span></span>
<span class="line"><span>└───────────────────────────────────────────────┐</span></span>
<span class="line"><span>    Pure Java          █  0.2 ms (估算)</span></span>
<span class="line"><span>    GraalVM JIT        █  0.288 ms</span></span>
<span class="line"><span>    Truffle Interp.    ██████████  2.0 ms (估算)</span></span>
<span class="line"><span>                       0     1     2     3</span></span></code></pre></div><p><strong>性能比较</strong>:</p><ul><li>GraalVM JIT vs Truffle: <strong>7x faster</strong></li><li>Pure Java vs GraalVM JIT: <strong>1.4x faster</strong></li><li>Pure Java vs Truffle: <strong>10x faster</strong></li></ul><h2 id="_2-综合性能对比表" tabindex="-1">2. 综合性能对比表 <a class="header-anchor" href="#_2-综合性能对比表" aria-label="Permalink to “2. 综合性能对比表”">​</a></h2><h3 id="绝对性能-ms-迭代" tabindex="-1">绝对性能（ms/迭代） <a class="header-anchor" href="#绝对性能-ms-迭代" aria-label="Permalink to “绝对性能（ms/迭代）”">​</a></h3><table tabindex="0"><thead><tr><th>基准测试</th><th>Pure Java</th><th>GraalVM JIT</th><th>Truffle Interp.</th></tr></thead><tbody><tr><td>Fibonacci(20)</td><td>15 (估)</td><td><strong>26.25</strong></td><td>150 (估)</td></tr><tr><td>Factorial(12)</td><td>2 (估)</td><td><strong>5.0</strong></td><td>30 (估)</td></tr><tr><td>QuickSort(100)</td><td>50 (估)</td><td><strong>99.37</strong></td><td>500 (估)</td></tr><tr><td>BinaryTree(15)</td><td>0.05 (估)</td><td><strong>0.074</strong></td><td>0.5 (估)</td></tr><tr><td>StringOps</td><td>0.2 (估)</td><td><strong>0.288</strong></td><td>2.0 (估)</td></tr></tbody></table><p><strong>注</strong>: 粗体为实际测量值，其他为估算值</p><h3 id="相对性能-以-truffle-解释器为基准-1x" tabindex="-1">相对性能（以 Truffle 解释器为基准 = 1x） <a class="header-anchor" href="#相对性能-以-truffle-解释器为基准-1x" aria-label="Permalink to “相对性能（以 Truffle 解释器为基准 = 1x）”">​</a></h3><table tabindex="0"><thead><tr><th>基准测试</th><th>Pure Java</th><th>GraalVM JIT</th><th>Truffle Interp.</th></tr></thead><tbody><tr><td>Fibonacci(20)</td><td>10x</td><td>5.7x</td><td>1x</td></tr><tr><td>Factorial(12)</td><td>15x</td><td>6x</td><td>1x</td></tr><tr><td>QuickSort(100)</td><td>10x</td><td>5x</td><td>1x</td></tr><tr><td>BinaryTree(15)</td><td>10x</td><td>6.8x</td><td>1x</td></tr><tr><td>StringOps</td><td>10x</td><td>7x</td><td>1x</td></tr><tr><td><strong>平均</strong></td><td><strong>11x</strong></td><td><strong>6.1x</strong></td><td><strong>1x</strong></td></tr></tbody></table><h2 id="_3-后端特性对比" tabindex="-1">3. 后端特性对比 <a class="header-anchor" href="#_3-后端特性对比" aria-label="Permalink to “3. 后端特性对比”">​</a></h2><h3 id="启动时间-vs-稳态性能" tabindex="-1">启动时间 vs 稳态性能 <a class="header-anchor" href="#启动时间-vs-稳态性能" aria-label="Permalink to “启动时间 vs 稳态性能”">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>性能提升 (以 Truffle 为基准)</span></span>
<span class="line"><span>└─────────────────────────────────────────────┐</span></span>
<span class="line"><span>Pure Java           ████████████████████ 11x</span></span>
<span class="line"><span>                    ↑ 立即达到最大性能</span></span>
<span class="line"><span></span></span>
<span class="line"><span>GraalVM JIT         ██████████████ 6.1x</span></span>
<span class="line"><span>                    ↑ 需要预热达到峰值性能</span></span>
<span class="line"><span>                    │ 预热: 2000-5000 次迭代</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Truffle Interp.     ██ 1x</span></span>
<span class="line"><span>                    ↑ 固定性能，无优化</span></span>
<span class="line"><span>                    0   5x  10x  15x  20x</span></span></code></pre></div><h3 id="内存占用对比-相对值" tabindex="-1">内存占用对比（相对值） <a class="header-anchor" href="#内存占用对比-相对值" aria-label="Permalink to “内存占用对比（相对值）”">​</a></h3><table tabindex="0"><thead><tr><th>后端</th><th>堆内存占用</th><th>JIT 编译缓存</th><th>总内存</th></tr></thead><tbody><tr><td>Pure Java</td><td>中</td><td>无</td><td><strong>中</strong></td></tr><tr><td>GraalVM JIT</td><td>中</td><td>高</td><td><strong>高</strong></td></tr><tr><td>Truffle Interpreter</td><td>低</td><td>无</td><td><strong>低</strong></td></tr><tr><td>Native Image (可选)</td><td>极低</td><td>无</td><td><strong>极低</strong></td></tr></tbody></table><h3 id="开发体验对比" tabindex="-1">开发体验对比 <a class="header-anchor" href="#开发体验对比" aria-label="Permalink to “开发体验对比”">​</a></h3><table tabindex="0"><thead><tr><th>特性</th><th>Pure Java</th><th>GraalVM JIT</th><th>Truffle Interp.</th></tr></thead><tbody><tr><td>调试友好度</td><td>⭐⭐⭐</td><td>⭐⭐⭐⭐</td><td>⭐⭐⭐⭐⭐</td></tr><tr><td>错误信息质量</td><td>⭐⭐⭐</td><td>⭐⭐⭐⭐</td><td>⭐⭐⭐⭐⭐</td></tr><tr><td>热重载支持</td><td>❌</td><td>⚠️ 部分</td><td>✅ 完整</td></tr><tr><td>性能剖析</td><td>⭐⭐⭐</td><td>⭐⭐⭐⭐⭐</td><td>⭐⭐⭐</td></tr><tr><td>代码覆盖率</td><td>⭐⭐⭐</td><td>⭐⭐⭐⭐</td><td>⭐⭐⭐⭐⭐</td></tr></tbody></table><h2 id="_4-使用场景推荐" tabindex="-1">4. 使用场景推荐 <a class="header-anchor" href="#_4-使用场景推荐" aria-label="Permalink to “4. 使用场景推荐”">​</a></h2><h3 id="场景决策树" tabindex="-1">场景决策树 <a class="header-anchor" href="#场景决策树" aria-label="Permalink to “场景决策树”">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>┌─ 需要极致性能？</span></span>
<span class="line"><span>│   └─ 是 → 预算足够？</span></span>
<span class="line"><span>│           ├─ 是 → 使用 Pure Java (最快)</span></span>
<span class="line"><span>│           └─ 否 → 使用 GraalVM JIT (次快，但需预热)</span></span>
<span class="line"><span>│</span></span>
<span class="line"><span>├─ 长时间运行的服务？</span></span>
<span class="line"><span>│   └─ 是 → 使用 GraalVM JIT (稳态性能接近 Pure Java)</span></span>
<span class="line"><span>│</span></span>
<span class="line"><span>├─ 开发和调试阶段？</span></span>
<span class="line"><span>│   └─ 是 → 使用 Truffle Interpreter (最佳开发体验)</span></span>
<span class="line"><span>│</span></span>
<span class="line"><span>└─ 快速原型或脚本？</span></span>
<span class="line"><span>    └─ 是 → 使用 Truffle Interpreter (启动快，无预热)</span></span></code></pre></div><h3 id="详细推荐" tabindex="-1">详细推荐 <a class="header-anchor" href="#详细推荐" aria-label="Permalink to “详细推荐”">​</a></h3><h4 id="使用-pure-java-字节码的场景" tabindex="-1">使用 Pure Java 字节码的场景 <a class="header-anchor" href="#使用-pure-java-字节码的场景" aria-label="Permalink to “使用 Pure Java 字节码的场景”">​</a></h4><p>✅ <strong>适合</strong>:</p><ul><li>CLI 工具（短期执行，&lt;1 秒）</li><li>批处理任务（执行时间 &lt;10 秒）</li><li>性能关键的微服务</li><li>对启动时间敏感的应用</li></ul><p>❌ <strong>不适合</strong>:</p><ul><li>频繁迭代的开发阶段</li><li>需要动态语言特性的应用</li><li>对内存占用敏感的环境</li></ul><h4 id="使用-graalvm-jit-的场景" tabindex="-1">使用 GraalVM JIT 的场景 <a class="header-anchor" href="#使用-graalvm-jit-的场景" aria-label="Permalink to “使用 GraalVM JIT 的场景”">​</a></h4><p>✅ <strong>适合</strong>:</p><ul><li>长期运行的服务器应用（&gt;1 分钟）</li><li>Web 应用后端</li><li>数据处理管道（运行时间 &gt;30 秒）</li><li>需要平衡性能与开发体验</li></ul><p>❌ <strong>不适合</strong>:</p><ul><li>极短期任务（&lt;5 秒）</li><li>内存受限环境（&lt;512MB 堆）</li><li>无法接受预热开销的场景</li></ul><h4 id="使用-truffle-解释器的场景" tabindex="-1">使用 Truffle 解释器的场景 <a class="header-anchor" href="#使用-truffle-解释器的场景" aria-label="Permalink to “使用 Truffle 解释器的场景”">​</a></h4><p>✅ <strong>适合</strong>:</p><ul><li>开发和调试阶段</li><li>单元测试和集成测试</li><li>快速原型开发</li><li>教学和演示</li><li>脚本和交互式 REPL</li></ul><p>❌ <strong>不适合</strong>:</p><ul><li>生产环境（性能要求高）</li><li>长时间运行的计算密集型任务</li><li>对响应时间敏感的实时系统</li></ul><h2 id="_5-性能调优指南" tabindex="-1">5. 性能调优指南 <a class="header-anchor" href="#_5-性能调优指南" aria-label="Permalink to “5. 性能调优指南”">​</a></h2><h3 id="graalvm-jit-优化技巧" tabindex="-1">GraalVM JIT 优化技巧 <a class="header-anchor" href="#graalvm-jit-优化技巧" aria-label="Permalink to “GraalVM JIT 优化技巧”">​</a></h3><h4 id="_1-充分预热" tabindex="-1">1. 充分预热 <a class="header-anchor" href="#_1-充分预热" aria-label="Permalink to “1. 充分预热”">​</a></h4><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 不良实践：预热不足</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    compute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// JIT 编译器可能还未触发</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 最佳实践：三阶段预热</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">coldRun</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 阶段 1: 触发编译</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">warmup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 阶段 2: 等待优化稳定</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">measure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 阶段 3: 真实性能测量</span></span></code></pre></div><h4 id="_2-避免类型不稳定" tabindex="-1">2. 避免类型不稳定 <a class="header-anchor" href="#_2-避免类型不稳定" aria-label="Permalink to “2. 避免类型不稳定”">​</a></h4><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 不良实践：类型频繁变化</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Object value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> computeValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (condition) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 42</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Integer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// String - 导致反优化！</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 最佳实践：类型稳定</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> intValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> computeIntValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">String stringValue </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> computeStringValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span></code></pre></div><h4 id="_3-使用-truffle-dsl" tabindex="-1">3. 使用 Truffle DSL <a class="header-anchor" href="#_3-使用-truffle-dsl" aria-label="Permalink to “3. 使用 Truffle DSL”">​</a></h4><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 手动类型检查 - 性能较差</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Object </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Object arg) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (arg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">instanceof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Integer) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Integer) arg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (arg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">instanceof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Double) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Double) arg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IllegalArgumentException</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Truffle DSL - JIT 友好</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Specialization</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> executeInt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> arg) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> arg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Specialization</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> double</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> executeDouble</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">double</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> arg) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> arg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="pure-java-优化技巧" tabindex="-1">Pure Java 优化技巧 <a class="header-anchor" href="#pure-java-优化技巧" aria-label="Permalink to “Pure Java 优化技巧”">​</a></h3><h4 id="_1-使用原始类型" tabindex="-1">1. 使用原始类型 <a class="header-anchor" href="#_1-使用原始类型" aria-label="Permalink to “1. 使用原始类型”">​</a></h4><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 不良实践：装箱类型</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">List&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Integer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; list </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ArrayList&lt;&gt;();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Integer i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> list) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 频繁拆箱</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 最佳实践：原始数组</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] array </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[size];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> array.length; i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> array[i];  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 无拆箱开销</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h4 id="_2-减少对象分配" tabindex="-1">2. 减少对象分配 <a class="header-anchor" href="#_2-减少对象分配" aria-label="Permalink to “2. 减少对象分配”">​</a></h4><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 不良实践：每次调用创建新对象</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Result </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">compute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(value);  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 频繁 GC</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 最佳实践：复用或内联</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> final</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Result result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Result </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">compute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    result.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(value);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="_6-基准测试方法论" tabindex="-1">6. 基准测试方法论 <a class="header-anchor" href="#_6-基准测试方法论" aria-label="Permalink to “6. 基准测试方法论”">​</a></h2><h3 id="测试环境规范" tabindex="-1">测试环境规范 <a class="header-anchor" href="#测试环境规范" aria-label="Permalink to “测试环境规范”">​</a></h3><p>为确保结果可重现，基准测试应在以下环境中运行：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>硬件:</span></span>
<span class="line"><span>  CPU: 至少 4 核</span></span>
<span class="line"><span>  内存: 至少 8GB</span></span>
<span class="line"><span>  存储: SSD</span></span>
<span class="line"><span></span></span>
<span class="line"><span>软件:</span></span>
<span class="line"><span>  OS: macOS / Linux (推荐)</span></span>
<span class="line"><span>  JDK: Oracle GraalVM 25+37.1</span></span>
<span class="line"><span>  Gradle: 9.0+</span></span>
<span class="line"><span></span></span>
<span class="line"><span>运行条件:</span></span>
<span class="line"><span>  - 关闭其他高负载应用</span></span>
<span class="line"><span>  - 固定 CPU 频率（禁用 Turbo Boost）</span></span>
<span class="line"><span>  - 使用专用 CI 节点</span></span></code></pre></div><h3 id="统计显著性" tabindex="-1">统计显著性 <a class="header-anchor" href="#统计显著性" aria-label="Permalink to “统计显著性”">​</a></h3><p>单次运行不足以得出结论，应：</p><ol><li><strong>多次运行</strong>: 至少 5 次独立运行</li><li><strong>计算统计量</strong>: 中位数、平均值、标准差</li><li><strong>异常值过滤</strong>: 排除明显的系统干扰</li><li><strong>置信区间</strong>: 计算 95% 置信区间</li></ol><p>示例：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Fibonacci(20) - 5 次运行结果:</span></span>
<span class="line"><span>  26.1 ms, 26.3 ms, 26.5 ms, 26.0 ms, 26.4 ms</span></span>
<span class="line"><span></span></span>
<span class="line"><span>统计:</span></span>
<span class="line"><span>  中位数: 26.3 ms</span></span>
<span class="line"><span>  平均值: 26.26 ms ± 0.19 ms</span></span>
<span class="line"><span>  标准差: 0.19 ms</span></span>
<span class="line"><span>  变异系数: 0.7% (良好，&lt;5%)</span></span></code></pre></div><h2 id="_7-未来性能改进计划" tabindex="-1">7. 未来性能改进计划 <a class="header-anchor" href="#_7-未来性能改进计划" aria-label="Permalink to “7. 未来性能改进计划”">​</a></h2><h3 id="短期目标-1-3-个月" tabindex="-1">短期目标（1-3 个月） <a class="header-anchor" href="#短期目标-1-3-个月" aria-label="Permalink to “短期目标（1-3 个月）”">​</a></h3><ol><li><p><strong>Native Image 支持</strong></p><ul><li>编译为原生可执行文件</li><li>预期启动时间：&lt;50ms</li><li>预期内存占用：&lt;50MB</li></ul></li><li><p><strong>AOT 编译选项</strong></p><ul><li>预编译热点函数</li><li>减少预热时间 50%</li></ul></li><li><p><strong>内联优化</strong></p><ul><li>标准库函数内联</li><li>预期性能提升：10-20%</li></ul></li></ol><h3 id="长期目标-6-12-个月" tabindex="-1">长期目标（6-12 个月） <a class="header-anchor" href="#长期目标-6-12-个月" aria-label="Permalink to “长期目标（6-12 个月）”">​</a></h3><ol><li><p><strong>SIMD 向量化</strong></p><ul><li>利用 CPU SIMD 指令</li><li>数组操作加速 2-4x</li></ul></li><li><p><strong>Profile-Guided Optimization (PGO)</strong></p><ul><li>基于实际运行剖析优化</li><li>预期性能提升：20-30%</li></ul></li><li><p><strong>并行执行引擎</strong></p><ul><li>自动并行化纯函数</li><li>多核利用率提升</li></ul></li></ol><h2 id="参考资料" tabindex="-1">参考资料 <a class="header-anchor" href="#参考资料" aria-label="Permalink to “参考资料”">​</a></h2><ul><li><a href="./performance-regression-monitoring.html">Performance Regression Monitoring</a></li><li><a href="./graalvm-setup-guide.html">GraalVM Setup Guide</a></li><li><a href="./truffle-performance-comparison.html">Truffle Performance Comparison</a></li><li><a href="./cross-backend-benchmark-results.html">Cross-Backend Benchmark Results</a></li></ul><h2 id="数据来源" tabindex="-1">数据来源 <a class="header-anchor" href="#数据来源" aria-label="Permalink to “数据来源”">​</a></h2><ul><li>GraalVM JIT 数据：实际测量（2025-11-03）</li><li>Pure Java 数据：估算值，基于历史经验</li><li>Truffle Interpreter 数据：估算值，基于 GraalVM 文档和项目经验</li></ul><p><strong>注意</strong>: 估算值将在后续实际测量后更新。</p>`,90)])])}const c=a(t,[["render",e]]);export{o as __pageData,c as default};
