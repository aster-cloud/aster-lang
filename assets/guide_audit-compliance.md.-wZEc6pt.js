import{_ as i,c as a,o as n,aj as t}from"./chunks/framework.Bz2R-749.js";const c=JSON.parse('{"title":"审计与合规指南","description":"","frontmatter":{},"headers":[],"relativePath":"guide/audit-compliance.md","filePath":"guide/audit-compliance.md"}'),h={name:"guide/audit-compliance.md"};function l(e,s,p,k,d,r){return n(),a("div",null,[...s[0]||(s[0]=[t(`<h1 id="审计与合规指南" tabindex="-1">审计与合规指南 <a class="header-anchor" href="#审计与合规指南" aria-label="Permalink to “审计与合规指南”">​</a></h1><blockquote><p><strong>状态</strong>: 用户指南 <strong>版本</strong>: 1.0 <strong>最后更新</strong>: 2025-11-27</p></blockquote><h2 id="概述" tabindex="-1">概述 <a class="header-anchor" href="#概述" aria-label="Permalink to “概述”">​</a></h2><p>Aster 提供企业级审计和合规功能，帮助组织满足 GDPR、HIPAA、SOC2 等法规要求。本指南涵盖防篡改审计日志、PII 合规检查、版本控制和回滚机制。</p><h2 id="合规功能矩阵" tabindex="-1">合规功能矩阵 <a class="header-anchor" href="#合规功能矩阵" aria-label="Permalink to “合规功能矩阵”">​</a></h2><table tabindex="0"><thead><tr><th>功能</th><th>GDPR</th><th>HIPAA</th><th>SOC2</th><th>状态</th></tr></thead><tbody><tr><td>防篡改审计日志</td><td>✅ Art. 30</td><td>✅ §164.312</td><td>✅ CC7.2</td><td>已实现</td></tr><tr><td>PII 污点追踪</td><td>✅ Art. 5</td><td>✅ PHI 保护</td><td>✅ CC6.1</td><td>已实现</td></tr><tr><td>数据脱敏</td><td>✅ Art. 25</td><td>✅ Safe Harbor</td><td>✅ CC6.6</td><td>已实现</td></tr><tr><td>同意管理</td><td>✅ Art. 6</td><td>✅ Authorization</td><td>-</td><td>已实现</td></tr><tr><td>版本控制</td><td>✅ Art. 17</td><td>✅ §164.530</td><td>✅ CC8.1</td><td>已实现</td></tr><tr><td>来源追踪</td><td>-</td><td>-</td><td>✅ CC6.8</td><td>已实现</td></tr></tbody></table><hr><h2 id="_1-防篡改审计日志" tabindex="-1">1. 防篡改审计日志 <a class="header-anchor" href="#_1-防篡改审计日志" aria-label="Permalink to “1. 防篡改审计日志”">​</a></h2><h3 id="工作原理" tabindex="-1">工作原理 <a class="header-anchor" href="#工作原理" aria-label="Permalink to “工作原理”">​</a></h3><p>Aster 使用 SHA-256 哈希链实现防篡改审计：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>┌─────────────┐    ┌─────────────┐    ┌─────────────┐</span></span>
<span class="line"><span>│  Record 1   │    │  Record 2   │    │  Record 3   │</span></span>
<span class="line"><span>│ prev: null  │───▶│ prev: hash1 │───▶│ prev: hash2 │</span></span>
<span class="line"><span>│ curr: hash1 │    │ curr: hash2 │    │ curr: hash3 │</span></span>
<span class="line"><span>└─────────────┘    └─────────────┘    └─────────────┘</span></span>
<span class="line"><span>    Genesis              Chain              Chain</span></span></code></pre></div><p>任何记录的删除、插入或修改都会导致哈希链断裂，立即被检测到。</p><h3 id="哈希计算规则" tabindex="-1">哈希计算规则 <a class="header-anchor" href="#哈希计算规则" aria-label="Permalink to “哈希计算规则”">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>content = prevHash + eventType + timestamp + tenantId</span></span>
<span class="line"><span>        + policyModule + policyFunction + success</span></span>
<span class="line"><span>currentHash = SHA256(content)</span></span></code></pre></div><h3 id="验证审计链" tabindex="-1">验证审计链 <a class="header-anchor" href="#验证审计链" aria-label="Permalink to “验证审计链”">​</a></h3><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> io.aster.audit.chain.AuditChainVerifier;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> io.aster.audit.chain.ChainVerificationResult;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ApplicationScoped</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AuditGuard</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Inject</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    AuditChainVerifier verifier;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> verifyBeforeExport</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(String </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">tenantId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ChainVerificationResult result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> verifier.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">verifyChainPaginated</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            tenantId,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            Instant.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">minus</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">14</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ChronoUnit.DAYS),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            Instant.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            500</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 分页大小</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        );</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isValid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IllegalStateException</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                &quot;审计链断裂，位置=&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getBrokenAt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                &quot;, 原因=&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getReason</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="数据库-schema" tabindex="-1">数据库 Schema <a class="header-anchor" href="#数据库-schema" aria-label="Permalink to “数据库 Schema”">​</a></h3><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- V2__create_audit_logs_table.sql</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> audit_logs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BIGSERIAL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    tenant_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    event_type </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    timestamp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TIMESTAMP WITH TIME ZONE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    policy_module </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    policy_function </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">128</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    success </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BOOLEAN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    prev_hash </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    current_hash </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    metadata JSONB,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    CONSTRAINT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> idx_audit_chain </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UNIQUE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (tenant_id, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">timestamp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, id)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> INDEX</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> idx_audit_tenant_time</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> audit_logs(tenant_id, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">timestamp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h3 id="性能建议" tabindex="-1">性能建议 <a class="header-anchor" href="#性能建议" aria-label="Permalink to “性能建议”">​</a></h3><table tabindex="0"><thead><tr><th>场景</th><th>建议</th></tr></thead><tbody><tr><td>日志量 &gt; 1000 条</td><td>使用 <code>verifyChainPaginated</code> 分页验证</td></tr><tr><td>多天数据</td><td>按天循环验证，设定最大窗口 24 小时</td></tr><tr><td>多租户</td><td>使用 <code>CompletableFuture</code> 并发校验</td></tr><tr><td>遗留数据</td><td>自动跳过无哈希字段的旧记录</td></tr></tbody></table><hr><h2 id="_2-pii-合规检查" tabindex="-1">2. PII 合规检查 <a class="header-anchor" href="#_2-pii-合规检查" aria-label="Permalink to “2. PII 合规检查”">​</a></h2><h3 id="pii-类型标注" tabindex="-1">PII 类型标注 <a class="header-anchor" href="#pii-类型标注" aria-label="Permalink to “PII 类型标注”">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Define User with</span></span>
<span class="line"><span>  email: @pii(L2, email) Text,</span></span>
<span class="line"><span>  ssn: @pii(L3, ssn) Text,</span></span>
<span class="line"><span>  name: @pii(L1, name) Text.</span></span></code></pre></div><table tabindex="0"><thead><tr><th>级别</th><th>说明</th><th>示例</th><th>法规要求</th></tr></thead><tbody><tr><td>L1</td><td>低敏感</td><td>姓名、偏好</td><td>GDPR Art. 6: 记录处理目的</td></tr><tr><td>L2</td><td>中敏感</td><td>邮箱、电话</td><td>GDPR Art. 6: 需合法依据</td></tr><tr><td>L3</td><td>高敏感</td><td>SSN、护照</td><td>GDPR Art. 9: 需明确同意</td></tr></tbody></table><h3 id="lsp-实时检测" tabindex="-1">LSP 实时检测 <a class="header-anchor" href="#lsp-实时检测" aria-label="Permalink to “LSP 实时检测”">​</a></h3><p>LSP 自动检测以下合规问题：</p><table tabindex="0"><thead><tr><th>错误码</th><th>问题</th><th>修复方案</th></tr></thead><tbody><tr><td>E400</td><td>HTTP 传输 PII</td><td>使用 HTTPS 或 <code>redact()</code></td></tr><tr><td>W074</td><td>日志泄露 PII</td><td>使用 <code>redact()</code> 脱敏</td></tr><tr><td>E403</td><td>缺失同意检查</td><td>添加 <code>@consent_required</code></td></tr></tbody></table><h3 id="数据脱敏函数" tabindex="-1">数据脱敏函数 <a class="header-anchor" href="#数据脱敏函数" aria-label="Permalink to “数据脱敏函数”">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>// redact() - 完全遮盖</span></span>
<span class="line"><span>Log.info(&quot;User: &quot; + redact(email))  // User: ***</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// tokenize() - 可逆令牌化</span></span>
<span class="line"><span>Let token be tokenize(ssn).</span></span>
<span class="line"><span>// 后续可通过 detokenize(token) 恢复</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// Crypto.hash() - 单向哈希</span></span>
<span class="line"><span>Let hashed be Crypto.hash(password, &quot;SHA-256&quot;).</span></span></code></pre></div><h3 id="同意检查" tabindex="-1">同意检查 <a class="header-anchor" href="#同意检查" aria-label="Permalink to “同意检查”">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>// 方式 1: 使用注解</span></span>
<span class="line"><span>@consent_required</span></span>
<span class="line"><span>To process_user with data: @pii(L2, email) Text:</span></span>
<span class="line"><span>  Return store(data).</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 方式 2: 显式检查</span></span>
<span class="line"><span>To process_user with data: @pii(L2, email) Text:</span></span>
<span class="line"><span>  checkConsent().</span></span>
<span class="line"><span>  Return store(data).</span></span></code></pre></div><p>详细配置请参阅 <a href="/docs/guide/pii-compliance.html">PII 合规最佳实践</a>。</p><hr><h2 id="_3-版本控制与变更追踪" tabindex="-1">3. 版本控制与变更追踪 <a class="header-anchor" href="#_3-版本控制与变更追踪" aria-label="Permalink to “3. 版本控制与变更追踪”">​</a></h2><h3 id="policy-版本历史" tabindex="-1">Policy 版本历史 <a class="header-anchor" href="#policy-版本历史" aria-label="Permalink to “Policy 版本历史”">​</a></h3><p>Policy Editor 自动记录每次修改：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>data/history/{policy-id}/</span></span>
<span class="line"><span>├── v1_2025-11-27T10-00-00.json</span></span>
<span class="line"><span>├── v2_2025-11-27T14-30-00.json</span></span>
<span class="line"><span>└── v3_2025-11-27T16-45-00.json</span></span></code></pre></div><h3 id="版本比较-api" tabindex="-1">版本比较 API <a class="header-anchor" href="#版本比较-api" aria-label="Permalink to “版本比较 API”">​</a></h3><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/policies/{id}/history&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PolicyHistoryResource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GET</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> List&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PolicyVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getHistory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PathParam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) String </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> policyService.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getVersionHistory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(id);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GET</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/diff&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PolicyDiff </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">compareVersions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">QueryParam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;v1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) String </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">v1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">QueryParam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;v2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) String </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">v2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> policyService.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">diff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(v1, v2);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="回滚操作" tabindex="-1">回滚操作 <a class="header-anchor" href="#回滚操作" aria-label="Permalink to “回滚操作”">​</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. 锁定目标版本</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fetch</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --tags</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> checkout</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> v0.x.y</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. 恢复依赖与产物</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ci</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. 清理缓存</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -rf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dist</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> node_modules/.cache</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ci</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 4. 验证</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ci</span></span></code></pre></div><hr><h2 id="_4-ai-生成代码来源追踪" tabindex="-1">4. AI 生成代码来源追踪 <a class="header-anchor" href="#_4-ai-生成代码来源追踪" aria-label="Permalink to “4. AI 生成代码来源追踪”">​</a></h2><h3 id="provenance-元数据" tabindex="-1">Provenance 元数据 <a class="header-anchor" href="#provenance-元数据" aria-label="Permalink to “Provenance 元数据”">​</a></h3><p>每个 AI 生成的文件都包含来源信息：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>// ========================================</span></span>
<span class="line"><span>// Generated by: Aster AI Code Generator</span></span>
<span class="line"><span>// Model: gpt-4</span></span>
<span class="line"><span>// Provider: openai</span></span>
<span class="line"><span>// Prompt: Calculate loan risk score</span></span>
<span class="line"><span>// Timestamp: 2025-11-27T10:30:00.000Z</span></span>
<span class="line"><span>// Validated: true</span></span>
<span class="line"><span>// ========================================</span></span></code></pre></div><h3 id="审计用途" tabindex="-1">审计用途 <a class="header-anchor" href="#审计用途" aria-label="Permalink to “审计用途”">​</a></h3><table tabindex="0"><thead><tr><th>字段</th><th>审计价值</th></tr></thead><tbody><tr><td>Model</td><td>追溯使用的 AI 模型版本</td></tr><tr><td>Provider</td><td>确定数据流向（OpenAI/Anthropic）</td></tr><tr><td>Prompt</td><td>记录业务意图</td></tr><tr><td>Timestamp</td><td>建立时间线</td></tr><tr><td>Validated</td><td>确认代码经过类型检查</td></tr></tbody></table><h3 id="提取元数据" tabindex="-1">提取元数据 <a class="header-anchor" href="#提取元数据" aria-label="Permalink to “提取元数据”">​</a></h3><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { ProvenanceTracker } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;aster-lang/ai/provenance&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> tracker</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ProvenanceTracker</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> metadata</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tracker.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">extractMetadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(code);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 写入审计日志</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">auditLog.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">record</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  eventType: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;AI_CODE_GENERATION&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  model: metadata.model,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  prompt: metadata.prompt,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  validated: metadata.validated</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><hr><h2 id="_5-合规配置" tabindex="-1">5. 合规配置 <a class="header-anchor" href="#_5-合规配置" aria-label="Permalink to “5. 合规配置”">​</a></h2><h3 id="aster-config-json" tabindex="-1">aster.config.json <a class="header-anchor" href="#aster-config-json" aria-label="Permalink to “aster.config.json”">​</a></h3><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;compliance&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;auditLog&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;enabled&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;hashAlgorithm&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SHA-256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;retentionDays&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">365</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;pii&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;enabled&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;strictMode&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;minLevel&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;L2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;allowedDomains&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;internal-api.company.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;provenance&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;enabled&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;includePrompt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="环境变量" tabindex="-1">环境变量 <a class="header-anchor" href="#环境变量" aria-label="Permalink to “环境变量”">​</a></h3><table tabindex="0"><thead><tr><th>变量</th><th>说明</th><th>默认值</th></tr></thead><tbody><tr><td><code>ASTER_AUDIT_ENABLED</code></td><td>启用审计日志</td><td><code>true</code></td></tr><tr><td><code>ASTER_PII_STRICT</code></td><td>PII 严格模式</td><td><code>false</code></td></tr><tr><td><code>ASTER_RETENTION_DAYS</code></td><td>日志保留天数</td><td><code>365</code></td></tr></tbody></table><hr><h2 id="_6-合规检查清单" tabindex="-1">6. 合规检查清单 <a class="header-anchor" href="#_6-合规检查清单" aria-label="Permalink to “6. 合规检查清单”">​</a></h2><h3 id="gdpr-准备" tabindex="-1">GDPR 准备 <a class="header-anchor" href="#gdpr-准备" aria-label="Permalink to “GDPR 准备”">​</a></h3><ul><li>[ ] 所有 PII 字段已标注敏感级别</li><li>[ ] 处理 PII 的函数包含同意检查</li><li>[ ] 审计日志启用且保留至少 6 年</li><li>[ ] 数据主体权利 API 已实现</li><li>[ ] 数据处理协议已与第三方签订</li></ul><h3 id="hipaa-准备" tabindex="-1">HIPAA 准备 <a class="header-anchor" href="#hipaa-准备" aria-label="Permalink to “HIPAA 准备”">​</a></h3><ul><li>[ ] PHI 数据使用 L3 级别标注</li><li>[ ] 传输使用 HTTPS 加密</li><li>[ ] 访问控制已配置</li><li>[ ] 审计日志支持 6 年保留</li><li>[ ] 应急响应计划已制定</li></ul><h3 id="soc2-准备" tabindex="-1">SOC2 准备 <a class="header-anchor" href="#soc2-准备" aria-label="Permalink to “SOC2 准备”">​</a></h3><ul><li>[ ] 审计链完整性验证已启用</li><li>[ ] AI 生成代码包含来源追踪</li><li>[ ] 版本控制和变更管理已实施</li><li>[ ] 访问日志可追溯</li><li>[ ] 定期安全评估已安排</li></ul><hr><h2 id="_7-故障排查" tabindex="-1">7. 故障排查 <a class="header-anchor" href="#_7-故障排查" aria-label="Permalink to “7. 故障排查”">​</a></h2><h3 id="审计链断裂" tabindex="-1">审计链断裂 <a class="header-anchor" href="#审计链断裂" aria-label="Permalink to “审计链断裂”">​</a></h3><table tabindex="0"><thead><tr><th>现象</th><th>原因</th><th>解决方案</th></tr></thead><tbody><tr><td><code>prev_hash mismatch</code></td><td>记录被删除或插入</td><td>检查数据库审计表操作历史</td></tr><tr><td><code>current_hash tampered</code></td><td>字段被修改</td><td>对比新旧值，检查补写流程</td></tr><tr><td>验证超时</td><td>查询窗口过大</td><td>使用分页验证，添加索引</td></tr></tbody></table><h3 id="pii-检测误报" tabindex="-1">PII 检测误报 <a class="header-anchor" href="#pii-检测误报" aria-label="Permalink to “PII 检测误报”">​</a></h3><ol><li>使用 <code>@safe-pii</code> 注解标记已审计代码</li><li>将净化函数添加到 <code>sanitizers</code> 配置</li><li>将内部域名加入 <code>allowedDomains</code></li></ol><hr><h2 id="相关文档" tabindex="-1">相关文档 <a class="header-anchor" href="#相关文档" aria-label="Permalink to “相关文档”">​</a></h2><ul><li><a href="/docs/guide/pii-compliance.html">PII 合规最佳实践</a></li><li><a href="/docs/guide/ai-code-generation.html">AI 代码生成指南</a></li><li><a href="/docs/phase0/tamper-evident-audit.html">防篡改审计日志技术文档</a></li><li><a href="/docs/operations/rollback.html">回滚操作指南</a></li></ul><hr><p><strong>免责声明</strong>：本指南提供技术实现指导，不构成法律建议。请咨询专业法律顾问以确保完整合规。</p>`,76)])])}const g=i(h,[["render",l]]);export{c as __pageData,g as default};
