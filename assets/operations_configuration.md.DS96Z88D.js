import{_ as s,c as i,o as a,aj as d}from"./chunks/framework.Bz2R-749.js";const k=JSON.parse('{"title":"配置手册","description":"","frontmatter":{},"headers":[],"relativePath":"operations/configuration.md","filePath":"operations/configuration.md"}'),e={name:"operations/configuration.md"};function n(l,t,h,p,r,o){return a(),i("div",null,[...t[0]||(t[0]=[d(`<blockquote><p>更新时间：2025-10-08 14:57（NZDT）<br> 执行者：Codex</p></blockquote><h1 id="配置手册" tabindex="-1">配置手册 <a class="header-anchor" href="#配置手册" aria-label="Permalink to “配置手册”">​</a></h1><h2 id="_1-环境变量清单" tabindex="-1">1. 环境变量清单 <a class="header-anchor" href="#_1-环境变量清单" aria-label="Permalink to “1. 环境变量清单”">​</a></h2><h3 id="_1-1-核心运行时" tabindex="-1">1.1 核心运行时 <a class="header-anchor" href="#_1-1-核心运行时" aria-label="Permalink to “1.1 核心运行时”">​</a></h3><table tabindex="0"><thead><tr><th>变量</th><th>必需</th><th>默认值</th><th>用途</th><th>示例值</th><th>生产建议</th></tr></thead><tbody><tr><td><code>NODE_ENV</code></td><td>是</td><td>未设置会导致健康检查失败</td><td>标识运行环境，决定配置与日志策略</td><td><code>NODE_ENV=production</code></td><td>必须设为 <code>production</code></td></tr><tr><td><code>ASTER_CAP_EFFECTS_ENFORCE</code></td><td>是（必须保持开启）</td><td>任意非 <code>0</code> 值视为开启</td><td>控制能力校验是否启用 (<code>src/config/runtime.ts</code>)</td><td><code>ASTER_CAP_EFFECTS_ENFORCE=1</code></td><td>生产禁止设为 <code>0</code></td></tr><tr><td><code>ASTER_CAPS</code></td><td>否</td><td>未设时跳过 manifest 校验</td><td>指向能力 manifest JSON，Typecheck/LSP 根据此校验</td><td><code>ASTER_CAPS=/etc/aster/caps.json</code></td><td>建议配置，保证能力治理</td></tr><tr><td><code>LOG_LEVEL</code></td><td>否</td><td><code>INFO</code></td><td>控制结构化日志最小级别 (<code>src/utils/logger.ts</code>)</td><td><code>LOG_LEVEL=DEBUG</code></td><td>生产保持 <code>INFO</code> 或以上</td></tr><tr><td><code>ASTER_DEBUG_TYPES</code></td><td>否</td><td>关闭</td><td>启用解析类型调试输出 (<code>src/parser.ts</code>)</td><td><code>ASTER_DEBUG_TYPES=1</code></td><td>仅调试开启</td></tr></tbody></table><h3 id="_1-2-构建与-jvm-工具链" tabindex="-1">1.2 构建与 JVM 工具链 <a class="header-anchor" href="#_1-2-构建与-jvm-工具链" aria-label="Permalink to “1.2 构建与 JVM 工具链”">​</a></h3><table tabindex="0"><thead><tr><th>变量</th><th>必需</th><th>默认值</th><th>用途</th><th>示例值</th><th>生产建议</th></tr></thead><tbody><tr><td><code>JAVA_HOME</code></td><td>是</td><td>依赖宿主环境</td><td>指向 GraalVM/Java 21 安装路径（Truffle/Gradle 脚本读取）</td><td><code>JAVA_HOME=/usr/lib/jvm/graalvm-21</code></td><td>确保指向可执行 <code>bin/java</code></td></tr><tr><td><code>GRADLE_OPTS</code></td><td>否</td><td>空字符串</td><td>追加到 Gradle 子进程参数（prefers IPv4/IPv6 由脚本默认追加）</td><td><code>GRADLE_OPTS=&#39;-Xmx4g&#39;</code></td><td>可用于调节内存</td></tr><tr><td><code>JAVA_OPTS</code></td><td>否</td><td>空字符串</td><td>JVM 启动参数，脚本默认追加网络偏好</td><td><code>JAVA_OPTS=&#39;-Xmx4g -Xms2g&#39;</code></td><td>根据容器资源调整</td></tr><tr><td><code>GRADLE_USER_HOME</code></td><td>否</td><td><code>~/.gradle</code></td><td>覆盖 Gradle 缓存目录，以便在沙箱/容器中持久化</td><td><code>GRADLE_USER_HOME=/var/cache/gradle</code></td><td>挂载到持久卷</td></tr><tr><td><code>ASTER_TRUFFLE_DEBUG</code></td><td>否</td><td><code>1</code>（脚本默认）</td><td>控制 Truffle 调试开关</td><td><code>ASTER_TRUFFLE_DEBUG=0</code></td><td>生产关闭以减少日志噪声</td></tr><tr><td><code>ASTER_ROOT</code></td><td>否</td><td>自动注入</td><td>CLI/脚本推断仓库根目录</td><td><code>ASTER_ROOT=/srv/aster</code></td><td>无需手动设置</td></tr><tr><td><code>INTEROP_NULL_STRICT</code></td><td>否</td><td>关闭</td><td>互操作空值严格模式验证脚本使用</td><td><code>INTEROP_NULL_STRICT=true</code></td><td>仅在验收或回归测试时开启</td></tr></tbody></table><h3 id="_1-3-lsp-与-pii-诊断配置" tabindex="-1">1.3 LSP 与 PII 诊断配置 <a class="header-anchor" href="#_1-3-lsp-与-pii-诊断配置" aria-label="Permalink to “1.3 LSP 与 PII 诊断配置”">​</a></h3><table tabindex="0"><thead><tr><th>变量/参数</th><th>必需</th><th>默认值</th><th>用途</th><th>示例值</th><th>生产建议</th></tr></thead><tbody><tr><td><code>--enforce-pii</code></td><td>否</td><td><code>false</code></td><td><strong>启用类型层 PII 流分析</strong>，检测隐私数据泄漏（E070/E072/E073）</td><td><code>aster-lsp --enforce-pii</code></td><td>开发环境建议启用</td></tr><tr><td><code>ENFORCE_PII</code></td><td>否</td><td><code>false</code></td><td>环境变量方式启用 PII 检查（优先级低于 <code>--enforce-pii</code>）</td><td><code>ENFORCE_PII=true</code></td><td>生产审计环境启用</td></tr><tr><td><code>ASTER_ENFORCE_PII</code></td><td>否</td><td><code>false</code></td><td>备用环境变量（与 <code>ENFORCE_PII</code> 等价，大小写无关）</td><td><code>ASTER_ENFORCE_PII=true</code></td><td>同上</td></tr><tr><td><code>--strict-pii</code></td><td>否</td><td><code>false</code></td><td><strong>控制语义层 PII 诊断严重级别</strong>：false=Warning，true=Error</td><td><code>aster-lsp --strict-pii</code></td><td>结合 <code>--enforce-pii</code> 使用</td></tr></tbody></table><h4 id="pii-诊断配置详解" tabindex="-1">PII 诊断配置详解 <a class="header-anchor" href="#pii-诊断配置详解" aria-label="Permalink to “PII 诊断配置详解”">​</a></h4><p><strong>配置优先级</strong>（从高到低）：</p><ol><li>LSP 配置注入（<code>--enforce-pii</code> CLI 参数）</li><li>环境变量（<code>ENFORCE_PII</code> / <code>ASTER_ENFORCE_PII</code>，大小写无关）</li><li>默认值：<code>false</code>（opt-in 策略，需显式启用）</li></ol><p><strong>--enforce-pii 与 --strict-pii 的区别</strong>：</p><table tabindex="0"><thead><tr><th>参数</th><th>作用范围</th><th>检测层次</th><th>诊断类型</th><th>严重级别控制</th></tr></thead><tbody><tr><td><code>--enforce-pii</code></td><td>启用/禁用 PII 检查</td><td><strong>类型层</strong>（完整流分析）</td><td>E070/E072/E073</td><td>固定为 Error</td></tr><tr><td><code>--strict-pii</code></td><td>控制诊断严重性</td><td><strong>语义层</strong>（HTTP 场景）</td><td>E400（HTTP 未加密）</td><td>false=Warning，true=Error</td></tr></tbody></table><p><strong>类型层 PII 诊断范围</strong>（需启用 <code>--enforce-pii</code>）：</p><ul><li><strong>E070</strong> (<code>PII_ASSIGN_DOWNGRADE</code>)：PII 数据赋值给 plain 变量，导致隐私级别降级</li><li><strong>E072</strong> (<code>PII_SINK_UNSANITIZED</code>)：PII 数据流向未授权 sink（如 HTTP/日志）</li><li><strong>E073</strong> (<code>PII_ARG_VIOLATION</code>)：函数参数 PII 级别不匹配，导致污染传播</li></ul><p><strong>推荐配置场景</strong>：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 场景 1：开发环境（全量检查 + 错误级别阻塞）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">aster-lsp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --enforce-pii</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --strict-pii</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 场景 2：CI/CD（启用检查，警告不阻塞构建）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">aster-lsp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --enforce-pii</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 场景 3：生产审计（通过环境变量启用）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ENFORCE_PII</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">true</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">aster-lsp</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 场景 4：默认行为（仅语义层 HTTP 警告，类型层 PII 检查禁用）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">aster-lsp</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 无参数，向后兼容</span></span></code></pre></div><p><strong>验证配置生效</strong>：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. 创建测试文件 test-pii.aster，包含 PII 违规代码</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;To test with pii@L2, produce Text: Return Http.post(&quot;url&quot;, pii).&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test-pii.aster</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. 启用 PII 检查并验证诊断</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ENFORCE_PII</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">true</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> typecheck</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test-pii.aster</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 预期：显示 E072 (PII_SINK_UNSANITIZED) 诊断</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. 禁用 PII 检查（默认行为）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> typecheck</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test-pii.aster</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 预期：不显示类型层 PII 诊断（E070/E072/E073）</span></span></code></pre></div><h3 id="_1-4-ci、发布与集成" tabindex="-1">1.4 CI、发布与集成 <a class="header-anchor" href="#_1-4-ci、发布与集成" aria-label="Permalink to “1.4 CI、发布与集成”">​</a></h3><table tabindex="0"><thead><tr><th>变量</th><th>必需</th><th>默认值</th><th>用途</th><th>示例值</th><th>生产建议</th></tr></thead><tbody><tr><td><code>GITHUB_TOKEN</code></td><td>CI 必需</td><td>GitHub 注入</td><td>Changesets/GitHub Release 工作流推送变更</td><td><code>GITHUB_TOKEN=ghp_xxx</code></td><td>CI 自动提供；本地需申请 PAT</td></tr><tr><td><code>GH_TOKEN</code></td><td>否</td><td>未设置</td><td><code>scripts/create-pr.js</code> 的备用 token</td><td><code>GH_TOKEN=ghp_alt</code></td><td>仅本地或自托管使用</td></tr><tr><td><code>GITHUB_REPOSITORY</code></td><td>CI 必需</td><td>GitHub 注入</td><td><code>owner/repo</code> 标识用于 PR 自动化</td><td><code>GITHUB_REPOSITORY=wontlost-ltd/aster-lang</code></td><td>CI 自动提供</td></tr><tr><td><code>NODE_AUTH_TOKEN</code></td><td>发布必需</td><td>未设置</td><td><code>npm publish</code> 所需凭据（通常等于 <code>NPM_TOKEN</code>）</td><td><code>export NODE_AUTH_TOKEN=$NPM_TOKEN</code></td><td>发布前显式导出</td></tr><tr><td><code>NPM_TOKEN</code></td><td>发布必需</td><td>未设置</td><td>npm registry 凭据</td><td><code>NPM_TOKEN=xxxx-xxxx</code></td><td>保存在 CI secrets</td></tr><tr><td><code>CI_DEBUG</code></td><td>否</td><td>未设置</td><td>CI 流程调试开关，控制部分 LSP smoke 脚本</td><td><code>CI_DEBUG=1</code></td><td>仅在排查时使用</td></tr></tbody></table><h2 id="_2-能力-manifest-格式" tabindex="-1">2. 能力 manifest 格式 <a class="header-anchor" href="#_2-能力-manifest-格式" aria-label="Permalink to “2. 能力 manifest 格式”">​</a></h2><ul><li>环境变量 <code>ASTER_CAPS</code> 指向 JSON 文件。</li><li>Manifest 更新后需重启 CLI/LSP 进程或重新运行 <code>npm run typecheck</code> 以重新加载。</li></ul><h3 id="_2-1-细粒度能力示例" tabindex="-1">2.1 细粒度能力示例 <a class="header-anchor" href="#_2-1-细粒度能力示例" aria-label="Permalink to “2.1 细粒度能力示例”">​</a></h3><ul><li>细粒度能力 manifest 示例：<div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;allow&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;Http&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;api.example.com/*&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;Sql&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;db.query*&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;Files&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;*&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li>支持同时配置 <code>deny</code>，仍然遵循 <code>deny</code> 优先于 <code>allow</code> 的规则。</li><li>通配符规则保持不变：<code>*</code>、<code>module.*</code>、<code>module.func</code>、<code>module.func*</code>。</li></ul><h3 id="_2-2-legacy-语法兼容" tabindex="-1">2.2 Legacy 语法兼容 <a class="header-anchor" href="#_2-2-legacy-语法兼容" aria-label="Permalink to “2.2 Legacy 语法兼容”">​</a></h3><ul><li>旧版 manifest 仍然兼容，可继续使用原有粗粒度能力：<div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;allow&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;io&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;*&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;cpu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;*&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li>粗粒度 <code>io</code> 等价于同时授予 <code>Http</code> 与 <code>Sql</code> 类能力，<code>cpu</code> 语法保持原状。</li></ul><h3 id="_2-3-能力类型速查表" tabindex="-1">2.3 能力类型速查表 <a class="header-anchor" href="#_2-3-能力类型速查表" aria-label="Permalink to “2.3 能力类型速查表”">​</a></h3><table tabindex="0"><thead><tr><th>能力</th><th>描述</th></tr></thead><tbody><tr><td>Http</td><td>HTTP 网络请求</td></tr><tr><td>Sql</td><td>数据库查询</td></tr><tr><td>Time</td><td>时间相关操作</td></tr><tr><td>Files</td><td>文件系统操作</td></tr><tr><td>Secrets</td><td>密钥和敏感数据访问</td></tr><tr><td>AiModel</td><td>AI 模型调用</td></tr><tr><td>CPU</td><td>CPU 密集型计算</td></tr></tbody></table><h2 id="_3-配置验证方法" tabindex="-1">3. 配置验证方法 <a class="header-anchor" href="#_3-配置验证方法" aria-label="Permalink to “3. 配置验证方法”">​</a></h2><ol><li>健康检查脚本：<div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NODE_ENV</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">production</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> node</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scripts/health-check.ts</span></span></code></pre></div><ul><li>若 <code>missingRequired</code> 非空，需要补全必需变量。</li></ul></li><li>结构化日志验证：<div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LOG_LEVEL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">DEBUG</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> node</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dist/scripts/cli.js</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test/cnl/examples/greet.aster</span></span></code></pre></div><ul><li>确认输出 JSON 包含 <code>level</code>, <code>timestamp</code>, <code>component</code>, <code>message</code>。</li></ul></li><li>能力校验验证：<div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ASTER_CAPS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">test/cnl/examples/capabilities.json</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> typecheck</span></span></code></pre></div><ul><li>确认能力违规会触发带有错误 ID（如 <code>E1001</code>）的诊断。</li></ul></li><li>安全基线：<div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> audit</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">           # audit-ci --moderate</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> audit-ci</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --high</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     # release/security workflow 同款</span></span></code></pre></div></li><li>Gradle/Java 链路：<div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"></span></code></pre></div></li></ol><p>npm run emit:class -- test/cnl/examples/greet.aster npm run javap:verify</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>- 若 \`JAVA_HOME\` 缺失会立即报错，部署前必须验证。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>## 4. 配置变更记录建议</span></span>
<span class="line"><span>- 所有环境变量变更需在配置管理系统（如 Vault/ConfigMap）中备份版本。</span></span>
<span class="line"><span>- Manifest 文件应通过代码审查合入（建议放置于 \`configs/aster/capabilities.json\`），并在变更 PR 中附带能力差异说明。</span></span>
<span class="line"><span>- 日志等级、能力校验开关等关键变量在生产环境变更前需通过变更审批。</span></span>
<span class="line"><span>- 发布脚本涉及的 token（\`NPM_TOKEN\`/\`GITHUB_TOKEN\`）统一由 CI 管理，避免写入仓库文件。</span></span></code></pre></div>`,34)])])}const g=s(e,[["render",n]]);export{k as __pageData,g as default};
